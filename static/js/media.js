/*! For license information please see media.js.LICENSE.txt */
!function(){var e,t={6369:function(e,t,a){"use strict";var i=a(2985),n=a(9471),r=a(8790),o=a(7460);function l(){return n.createElement("div",{className:"player-container viewer-attachment-container"},n.createElement("div",{className:"player-container-inner"},n.createElement("span",null,n.createElement("span",null,n.createElement("i",{className:"material-icons"},"insert_drive_file")))))}var s=a(8713),d=a.n(s),c=a(4480),u=a.n(c),m=a(1838),p=a(285),h=a(7154);function g(e){let t=null,a=e.split(".");if(a.length)switch(a=a[a.length-1],a){case"webm":t="audio/webm";break;case"flac":t="audio/flac";break;case"wave":t="audio/wave";break;case"wav":t="audio/wav";break;case"ogg":case"ogg":t="audio/ogg";break;case"mp3":case"mpeg":t="audio/mpeg"}return t}var f=a(8974);class v extends n.PureComponent{constructor(e){super(e);let t=o.MediaPageStore.get("media-data");this.AudioPlayerData={},this.audioStartedPlaying=!1;let a=(0,m.formatInnerLink)(t.original_media_url,r.SiteContext._currentValue.url);this.videoSources=[{src:a,type:g(a)}],this.videoPoster=t.poster_url,this.videoPoster=this.videoPoster?this.videoPoster:t.thumbnail_url,this.videoPoster=this.videoPoster?(0,m.formatInnerLink)(this.videoPoster,r.SiteContext._currentValue.url):"",this.updatePlayerVolume=this.updatePlayerVolume.bind(this),this.onAudioEnd=this.onAudioEnd.bind(this),this.onAudioRestart=this.onAudioRestart.bind(this),o.PageStore.on("switched_media_auto_play",this.onUpdateMediaAutoPlay.bind(this)),this.wrapperClick=this.wrapperClick.bind(this);const i=new h.MediaDurationInfo;i.update(o.MediaPageStore.get("media-data").duration),this.durationISO8601=i.ISO8601()}componentDidMount(){this.videoSources.length||f.warn("Audio DEBUG:","Audio file doesn't exist"),this.recommendedMedia=o.MediaPageStore.get("media-data").related_media.length?new h.PlayerRecommendedMedia(o.MediaPageStore.get("media-data").related_media,this.refs.AudioElem.parentNode,this.props.inEmbed):null,this.upNextLoaderView=!this.props.inEmbed&&o.MediaPageStore.get("media-data").related_media.length?new h.UpNextLoaderView(o.MediaPageStore.get("media-data").related_media[0]):null,document.hasFocus()||"visible"===document.visibilityState?this.initPlayerInstance():(this.initPlayerInstance=this.initPlayerInstance.bind(this),window.addEventListener("focus",this.initPlayerInstance),document.addEventListener("visibilitychange",this.initPlayerInstance))}componentWillUnmount(){this.recommendedMedia&&(this.AudioPlayerData.instance.player.off("fullscreenchange",this.recommendedMedia.onResize),o.PageStore.removeListener("window_resize",this.recommendedMedia.onResize),o.VideoViewerStore.removeListener("changed_viewer_mode",this.recommendedMedia.onResize),this.recommendedMedia.destroy()),videojs(this.refs.AudioElem).dispose(),this.AudioPlayerData.instance=null,delete this.AudioPlayerData.instance}initPlayerInstance(){window.removeEventListener("focus",this.initPlayerInstance),document.removeEventListener("visibilitychange",this.initPlayerInstance),this.refs.AudioElem.focus(),this.initPlayerInstance=null,setTimeout(function(){if(!this.AudioPlayerData.instance){let e=this.props.inEmbed?document.createElement("a"):null,t=this.props.inEmbed?document.createElement("a"):null;e&&(e.setAttribute("class","title-link"),e.setAttribute("href",o.MediaPageStore.get("media-data").url),e.setAttribute("title",o.MediaPageStore.get("media-data").title),e.setAttribute("target","_blank"),e.innerHTML=o.MediaPageStore.get("media-data").title),t&&(t.setAttribute("class","user-thumb-link"),t.setAttribute("href",o.MediaPageStore.get("media-data").author_profile),t.setAttribute("title",o.MediaPageStore.get("media-data").author_name),t.setAttribute("target","_blank"),t.innerHTML='<img src="'+o.MediaPageStore.get("media-author-thumbnail-url")+'" alt="" />');let a=null,i=null;!this.props.inEmbed&&o.MediaPageStore.get("playlist-id")?(a=o.MediaPageStore.get("playlist-next-media-url"),i=o.MediaPageStore.get("playlist-previous-media-url")):a=o.MediaPageStore.get("media-data").related_media.length&&!this.props.inEmbed?o.MediaPageStore.get("media-data").related_media[0].url:null,this.AudioPlayerData.instance=new(u())(this.refs.AudioElem,{sources:this.videoSources,poster:this.videoPoster,autoplay:!this.props.inEmbed,bigPlayButton:!0,controlBar:{fullscreen:!1,theaterMode:!1,next:!!a,previous:!!i},cornerLayers:{topLeft:e,topRight:this.upNextLoaderView?this.upNextLoaderView.html():null,bottomLeft:this.recommendedMedia?this.recommendedMedia.html():null,bottomRight:t}},{volume:o.VideoViewerStore.get("player-volume"),soundMuted:o.VideoViewerStore.get("player-sound-muted")},null,null,this.onAudioPlayerStateUpdate.bind(this),this.onClickNextButton.bind(this),this.onClickPreviousButton.bind(this)),this.upNextLoaderView&&(this.upNextLoaderView.setVideoJsPlayerElem(this.AudioPlayerData.instance.player.el_),this.onUpdateMediaAutoPlay()),this.refs.AudioElem.parentNode.focus(),this.AudioPlayerData.instance.player.one("play",function(){this.audioStartedPlaying=!0}.bind(this)),this.recommendedMedia&&(this.recommendedMedia.initWrappers(this.AudioPlayerData.instance.player.el_),this.AudioPlayerData.instance.player.one("pause",this.recommendedMedia.init),this.AudioPlayerData.instance.player.on("fullscreenchange",this.recommendedMedia.onResize),o.PageStore.on("window_resize",this.recommendedMedia.onResize),o.VideoViewerStore.on("changed_viewer_mode",this.recommendedMedia.onResize)),this.AudioPlayerData.instance.player.one("ended",this.onAudioEnd)}}.bind(this),50)}initialDocumentFocus(){this.refs.AudioElem.parentNode&&(this.refs.AudioElem.parentNode.focus(),setTimeout(function(){this.AudioPlayerData.instance.player.play()}.bind(this),50)),window.removeEventListener("focus",this.initialDocumentFocus),this.initialDocumentFocus=null}onClickNextButton(){let e;o.MediaPageStore.get("playlist-id")?(e=o.MediaPageStore.get("playlist-next-media-url"),null===e&&(e=o.MediaPageStore.get("media-data").related_media[0].url)):this.props.inEmbed||(e=o.MediaPageStore.get("media-data").related_media[0].url),window.location.href=e}onClickPreviousButton(){let e;o.MediaPageStore.get("playlist-id")?(e=o.MediaPageStore.get("playlist-previous-media-url"),null===e&&(e=o.MediaPageStore.get("media-data").related_media[0].url)):this.props.inEmbed||(e=o.MediaPageStore.get("media-data").related_media[0].url),window.location.href=e}onUpdateMediaAutoPlay(){this.upNextLoaderView&&(o.PageStore.get("media-auto-play")?this.upNextLoaderView.showTimerView(this.AudioPlayerData.instance.isEnded()):this.upNextLoaderView.hideTimerView())}onAudioPlayerStateUpdate(e){this.updatePlayerVolume(e.volume,e.soundMuted)}onAudioRestart(){this.recommendedMedia&&(this.recommendedMedia.updateDisplayType("inline"),this.AudioPlayerData.instance.player.one("pause",this.recommendedMedia.init),this.AudioPlayerData.instance.player.one("ended",this.onAudioEnd))}onAudioEnd(){if(this.recommendedMedia&&(this.recommendedMedia.updateDisplayType("full"),this.AudioPlayerData.instance.player.one("playing",this.onAudioRestart)),!this.props.inEmbed&&o.MediaPageStore.get("playlist-id")){const e=document.querySelector(".video-player .more-media"),t=document.querySelector(".video-player .vjs-actions-anim");this.upNextLoaderView.cancelTimer();const a=o.MediaPageStore.get("playlist-next-media-url");return a&&(e&&(e.style.display="none"),t&&(t.style.display="none"),window.location.href=a),void this.upNextLoaderView.hideTimerView()}this.upNextLoaderView&&(o.PageStore.get("media-auto-play")?(this.upNextLoaderView.startTimer(),this.AudioPlayerData.instance.player.one("play",function(){this.upNextLoaderView.cancelTimer()}.bind(this))):this.upNextLoaderView.cancelTimer())}onUpdateMediaAutoPlay(){this.upNextLoaderView&&(o.PageStore.get("media-auto-play")?this.upNextLoaderView.showTimerView(this.AudioPlayerData.instance.isEnded()):this.upNextLoaderView.hideTimerView())}updatePlayerVolume(e,t){o.VideoViewerStore.get("player-volume")!==e&&p.VideoViewerActions.set_player_volume(e),o.VideoViewerStore.get("player-sound-muted")!==t&&p.VideoViewerActions.set_player_sound_muted(t)}wrapperClick(e){e.target.parentNode===this.refs.videoPlayerWrap&&(this.AudioPlayerData.instance.player.ended()||(!this.AudioPlayerData.instance.player.hasStarted_||this.AudioPlayerData.instance.player.paused()?this.AudioPlayerData.instance.player.play():this.AudioPlayerData.instance.player.pause()))}render(){return n.createElement("div",{className:"player-container audio-player-container"},n.createElement("div",{className:"player-container-inner"},n.createElement("div",{className:"video-player",ref:"videoPlayerWrap",onClick:this.wrapperClick},n.createElement("audio",{tabIndex:"1",ref:"AudioElem",className:"video-js vjs-mediacms native-dimensions"}))))}}function y(e){const t=(0,n.useContext)(r.SiteContext);let a=d();a=a||o.MediaPageStore.get("media-data").thumbnail_url,a=a||"";const[i,l]=(0,n.useState)(a);function s(){l(d())}function d(){const e=o.MediaPageStore.get("media-data");let a="string"==typeof e.poster_url?e.poster_url.trim():"";return""===a&&(a="string"==typeof e.thumbnail_url?e.thumbnail_url.trim():""),""===a&&(a="string"==typeof o.MediaPageStore.get("media-original-url")?o.MediaPageStore.get("media-original-url").trim():""),""===a?"#":t.url+"/"+a.replace(/^\//g,"")}return(0,n.useEffect)((()=>(o.MediaPageStore.on("loaded_image_data",s),()=>o.MediaPageStore.removeListener("loaded_image_data",s))),[]),i?n.createElement("div",{className:"viewer-image-container"},n.createElement("img",{src:i,alt:o.MediaPageStore.get("media-data").title||null})):null}function b(){return n.createElement("div",{className:"player-container viewer-pdf-container"},n.createElement("div",{className:"player-container-inner"},n.createElement("span",null,n.createElement("span",null,n.createElement("i",{className:"material-icons"},"insert_drive_file")))))}v.defaultProps={inEmbed:!1},v.propTypes={inEmbed:d().bool};var E=a(2818),S=a(5615),P=a(8974);class M extends n.PureComponent{constructor(e){if(super(e),this.state={displayPlayer:!1},this.videoSources=[],function(e){switch(e){case"running":o.MediaPageStore.set("media-load-error-type","encodingRunning"),o.MediaPageStore.set("media-load-error-message","Media encoding is currently running. Try again in few minutes.");break;case"pending":o.MediaPageStore.set("media-load-error-type","encodingPending"),o.MediaPageStore.set("media-load-error-message","Media encoding is pending");break;case"fail":o.MediaPageStore.set("media-load-error-type","encodingFailed"),o.MediaPageStore.set("media-load-error-message","Media encoding failed")}}(this.props.data.encoding_status),null!==o.MediaPageStore.get("media-load-error-type"))return void(this.state.displayPlayer=!0);if("string"==typeof this.props.data.poster_url?this.videoPoster=(0,m.formatInnerLink)(this.props.data.poster_url,this.props.siteUrl):"string"==typeof this.props.data.thumbnail_url&&(this.videoPoster=(0,m.formatInnerLink)(this.props.data.thumbnail_url,this.props.siteUrl)),this.videoInfo=(0,E.uW)(this.props.data.encodings_info,this.props.data.hls_info),Object.keys(this.videoInfo).length){let e=o.VideoViewerStore.get("video-quality");(null===e||"Auto"===e&&void 0===this.videoInfo.Auto)&&(e=720);let t=(0,E.OQ)(e,this.videoInfo);"Auto"===e&&void 0!==this.videoInfo.Auto&&this.videoSources.push({src:this.videoInfo.Auto.url[0]});const a=(0,E.n1)();let i,n;for(n=0;n<this.videoInfo[t].format.length;){if("hls"===this.videoInfo[t].format[n]){this.videoSources.push({src:this.videoInfo[t].url[n]});break}n+=1}for(n in this.props.data.encodings_info[t])this.props.data.encodings_info[t].hasOwnProperty(n)&&a.support[n]&&(i=this.props.data.encodings_info[t][n].url,i&&(i=(0,m.formatInnerLink)(i,this.props.siteUrl),this.videoSources.push({src:i,encodings_status:this.props.data.encodings_info[t][n].status})))}else this.videoInfo=null;if(this.videoSources.length){if(!this.props.inEmbed&&1===this.videoSources.length&&"running"===this.videoSources[0].encodings_status)return o.MediaPageStore.set("media-load-error-type","encodingRunning"),void o.MediaPageStore.set("media-load-error-message","Media encoding is currently running. Try again in few minutes.")}else switch(o.MediaPageStore.get("media-load-error-type")){case"encodingRunning":case"encodingPending":case"encodingFailed":break;default:P.warn("VIDEO DEBUG:","Video files don't exist")}o.PageStore.on("switched_media_auto_play",this.onUpdateMediaAutoPlay.bind(this)),this.browserCache=new h.BrowserCache(r.SiteContext._currentValue.id,86400);const t=new h.MediaDurationInfo;t.update(this.props.data.duration),this.durationISO8601=t.ISO8601(),this.playerElem=null,this.playerInstance=null,this.onPlayerInit=this.onPlayerInit.bind(this),this.onClickNext=this.onClickNext.bind(this),this.onClickPrevious=this.onClickPrevious.bind(this),this.onStateUpdate=this.onStateUpdate.bind(this),this.onVideoEnd=this.onVideoEnd.bind(this),this.onVideoRestart=this.onVideoRestart.bind(this)}componentDidMount(){if(this.videoSources.length){this.recommendedMedia=this.props.data.related_media.length?new h.PlayerRecommendedMedia(this.props.data.related_media,this.props.inEmbed,!o.PageStore.get("config-media-item").displayViews):null,this.upNextLoaderView=!this.props.inEmbed&&this.props.data.related_media.length?new h.UpNextLoaderView(this.props.data.related_media[0]):null;let e=null;if(this.props.inEmbed){let t=document.createElement("a"),a=document.createElement("a");e=document.createElement("div"),e.setAttribute("class","media-links-top-left"),t&&(t.setAttribute("class","title-link"),t.setAttribute("href",this.props.data.url),t.setAttribute("title",this.props.data.title),t.setAttribute("target","_blank"),t.innerHTML=this.props.data.title),a&&(a.setAttribute("class","user-thumb-link"),a.setAttribute("href",(0,m.formatInnerLink)(this.props.data.author_profile,this.props.siteUrl)),a.setAttribute("title",this.props.data.author_name),a.setAttribute("target","_blank"),a.setAttribute("style","background-image:url("+(0,m.formatInnerLink)(o.MediaPageStore.get("media-author-thumbnail-url"),this.props.siteUrl)+")")),e.appendChild(a),e.appendChild(t)}const t=o.MediaPageStore.get("media-url");let a='<button class="share-video-btn"><i class="material-icons">share</i><span>Share</span></button>';a+='<div class="share-options-wrapper">\t\t\t\t\t\t\t\t\t<div class="share-options">\t\t\t\t\t\t\t\t\t\t<div class="share-options-inner">\t\t\t\t\t\t\t\t\t\t\t<div class="sh-option share-email">\t\t\t\t\t\t\t\t\t\t\t\t<a href="mailto:?body='+t+'" title=""><span><i class="material-icons">email</i></span><span>Email</span></a>\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\t<div class="sh-option share-fb">\t\t\t\t\t\t\t\t\t\t\t\t<a href="https://www.facebook.com/sharer.php?u='+t+'" title="" target="_blank"><span></span><span>Facebook</span></a>\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\t<div class="sh-option share-tw">\t\t\t\t\t\t\t\t\t\t\t\t<a href="https://twitter.com/intent/tweet?url='+t+'" title="" target="_blank"><span></span><span>Twitter</span></a>\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\t<div class="sh-option share-whatsapp">\t\t\t\t\t\t\t\t\t\t\t\t<a href="whatsapp://send?text='+t+'" title="" target="_blank" data-action="share/whatsapp/share"><span></span><span>WhatsApp</span></a>\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\t<div class="sh-option share-telegram">\t\t\t\t\t\t\t\t\t\t\t\t<a href="https://t.me/share/url?url='+t+"&amp;text="+this.props.data.title+'" title="" target="_blank"><span></span><span>Telegram</span></a>\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\t<div class="sh-option share-linkedin">\t\t\t\t\t\t\t\t\t\t\t\t\t<a href="https://www.linkedin.com/shareArticle?mini=true&amp;url='+t+'" title="" target="_blank"><span></span><span>LinkedIn</span></a>\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\t<div class="sh-option share-reddit">\t\t\t\t\t\t\t\t\t\t\t\t<a href="https://reddit.com/submit?url='+t+"&amp;title="+this.props.data.title+'" title="" target="_blank"><span></span><span>reddit</span></a>\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\t<div class="sh-option share-tumblr">\t\t\t\t\t\t\t\t\t\t\t\t<a href="https://www.tumblr.com/widgets/share/tool?canonicalUrl='+t+"&amp;title="+this.props.data.title+'" title="" target="_blank"><span></span><span>Tumblr</span></a>\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\t<div class="sh-option share-pinterest">\t\t\t\t\t\t\t\t\t\t\t\t<a href="http://pinterest.com/pin/create/link/?url='+t+'" title="" target="_blank"><span></span><span>Pinterest</span></a>\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\t<div class="sh-option share-more">\t\t\t\t\t\t\t\t\t\t\t\t<a href="'+t+'" title="More" target="_blank"><span><i class="material-icons">more_horiz</i></span><span></span></a>\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t</div>',this.cornerLayers={topLeft:e,topRight:this.upNextLoaderView?this.upNextLoaderView.html():null,bottomLeft:this.recommendedMedia?this.recommendedMedia.html():null,bottomRight:this.props.inEmbed?a:null},this.setState({displayPlayer:!0},(function(){setTimeout((function(){const e=document.querySelector(".share-video-btn"),t=document.querySelector(".share-options-wrapper"),a=document.querySelector(".share-options-inner");e&&e.addEventListener("click",(function(e){(0,m.addClassname)(document.querySelector(".video-js.vjs-mediacms"),"vjs-visible-share-options")})),t&&t.addEventListener("click",(function(e){e.target!==a&&e.target!==t||(0,m.removeClassname)(document.querySelector(".video-js.vjs-mediacms"),"vjs-visible-share-options")}))}),1e3)}))}}componentWillUnmount(){this.unsetRecommendedMedia()}initRecommendedMedia(){null!==this.recommendedMedia&&(this.props.inEmbed||this.recommendedMedia.init(),this.playerInstance.player.on("fullscreenchange",this.recommendedMedia.onResize),o.PageStore.on("window_resize",this.recommendedMedia.onResize),o.VideoViewerStore.on("changed_viewer_mode",this.recommendedMedia.onResize))}unsetRecommendedMedia(){null!==this.recommendedMedia&&(this.playerInstance.player.off("fullscreenchange",this.recommendedMedia.onResize),o.PageStore.removeListener("window_resize",this.recommendedMedia.onResize),o.VideoViewerStore.removeListener("changed_viewer_mode",this.recommendedMedia.onResize),this.recommendedMedia.destroy())}onClickNext(){let e;o.MediaPageStore.get("playlist-id")?(e=o.MediaPageStore.get("playlist-next-media-url"),null===e&&(e=this.props.data.related_media[0].url)):this.props.inEmbed||(e=this.props.data.related_media[0].url),window.location.href=e}onClickPrevious(){let e;o.MediaPageStore.get("playlist-id")?(e=o.MediaPageStore.get("playlist-previous-media-url"),null===e&&(e=this.props.data.related_media[0].url)):this.props.inEmbed||(e=this.props.data.related_media[0].url),window.location.href=e}onStateUpdate(e){o.VideoViewerStore.get("in-theater-mode")!==e.theaterMode&&p.VideoViewerActions.set_viewer_mode(e.theaterMode),o.VideoViewerStore.get("player-volume")!==e.volume&&p.VideoViewerActions.set_player_volume(e.volume),o.VideoViewerStore.get("player-sound-muted")!==e.soundMuted&&p.VideoViewerActions.set_player_sound_muted(e.soundMuted),o.VideoViewerStore.get("video-quality")!==e.quality&&p.VideoViewerActions.set_video_quality(e.quality),o.VideoViewerStore.get("video-playback-speed")!==e.playbackSpeed&&p.VideoViewerActions.set_video_playback_speed(e.playbackSpeed)}onPlayerInit(e,t){this.playerElem=t,this.playerInstance=e,this.upNextLoaderView&&(this.upNextLoaderView.setVideoJsPlayerElem(this.playerInstance.player.el_),this.onUpdateMediaAutoPlay()),this.props.inEmbed||this.playerElem.parentNode.focus(),null!==this.recommendedMedia&&(this.recommendedMedia.initWrappers(this.playerElem.parentNode),this.props.inEmbed&&(this.playerInstance.player.one("pause",this.recommendedMedia.init),this.initRecommendedMedia())),this.playerInstance.player.one("ended",this.onVideoEnd)}onVideoRestart(){null!==this.recommendedMedia&&(this.recommendedMedia.updateDisplayType("inline"),this.props.inEmbed&&this.playerInstance.player.one("pause",this.recommendedMedia.init),this.playerInstance.player.one("ended",this.onVideoEnd))}onVideoEnd(){if(null!==this.recommendedMedia&&(this.props.inEmbed||this.initRecommendedMedia(),this.recommendedMedia.updateDisplayType("full"),this.playerInstance.player.one("playing",this.onVideoRestart)),!this.props.inEmbed&&o.MediaPageStore.get("playlist-id")){const e=document.querySelector(".video-player .more-media"),t=document.querySelector(".video-player .vjs-actions-anim");this.upNextLoaderView.cancelTimer();const a=o.MediaPageStore.get("playlist-next-media-url");return a&&(e&&(e.style.display="none"),t&&(t.style.display="none"),window.location.href=a),void this.upNextLoaderView.hideTimerView()}this.upNextLoaderView&&(o.PageStore.get("media-auto-play")?(this.upNextLoaderView.startTimer(),this.playerInstance.player.one("play",function(){this.upNextLoaderView.cancelTimer()}.bind(this))):this.upNextLoaderView.cancelTimer())}onUpdateMediaAutoPlay(){this.upNextLoaderView&&(o.PageStore.get("media-auto-play")?this.upNextLoaderView.showTimerView(this.playerInstance.isEnded()):this.upNextLoaderView.hideTimerView())}render(){let e=null,t=null;!this.props.inEmbed&&o.MediaPageStore.get("playlist-id")?(e=o.MediaPageStore.get("playlist-next-media-url"),t=o.MediaPageStore.get("playlist-previous-media-url")):e=this.props.data.related_media.length&&!this.props.inEmbed?this.props.data.related_media[0].url:null;const a=this.props.data.sprites_url?{url:this.props.siteUrl+"/"+this.props.data.sprites_url.replace(/^\//g,""),frame:{width:160,height:90,seconds:10}}:null;return n.createElement("div",{key:(this.props.inEmbed?"embed-":"")+"player-container",className:"player-container"+(this.videoSources.length?"":" player-container-error"),style:this.props.containerStyles,ref:"playerContainer"},n.createElement("div",{className:"player-container-inner",ref:"playerContainerInner",style:this.props.containerStyles},this.state.displayPlayer&&null!==o.MediaPageStore.get("media-load-error-type")?n.createElement(S.lg,{errorMessage:o.MediaPageStore.get("media-load-error-message")}):null,this.state.displayPlayer&&null==o.MediaPageStore.get("media-load-error-type")?n.createElement("div",{className:"video-player",ref:"videoPlayerWrapper",key:"videoPlayerWrapper"},n.createElement(r.SiteConsumer,null,(i=>n.createElement(S.L9,{playerVolume:this.browserCache.get("player-volume"),playerSoundMuted:this.browserCache.get("player-sound-muted"),videoQuality:this.browserCache.get("video-quality"),videoPlaybackSpeed:parseInt(this.browserCache.get("video-playback-speed"),10),inTheaterMode:this.browserCache.get("in-theater-mode"),siteId:i.id,siteUrl:i.url,info:this.videoInfo,cornerLayers:this.cornerLayers,sources:this.videoSources,poster:this.videoPoster,previewSprite:a,subtitlesInfo:this.props.data.subtitles_info,enableAutoplay:!this.props.inEmbed,inEmbed:this.props.inEmbed,hasTheaterMode:!this.props.inEmbed,hasNextLink:!!e,hasPreviousLink:!!t,errorMessage:o.MediaPageStore.get("media-load-error-message"),onClickNextCallback:this.onClickNext,onClickPreviousCallback:this.onClickPrevious,onStateUpdateCallback:this.onStateUpdate,onPlayerInitCallback:this.onPlayerInit})))):null))}}function w(e){let t=null,a=[];var i=location.search.substr(1).split("&");for(let n=0;n<i.length;n++)a=i[n].split("="),a[0]===e&&(t=decodeURIComponent(a[1]));return t}M.defaultProps={inEmbed:!0,siteUrl:d().string.isRequired},M.propTypes={inEmbed:d().bool},new MutationObserver((function(e,t){const a=document.querySelector(".video-js.vjs-mediacms video");if(a)return function(e){const t=videojs(e);t.playsinline(!0),1==w("muted")&&t.muted(!0),w("time")>=0&&t.currentTime(w("time")),1==w("autoplay")&&t.play()}(a),void t.disconnect()})).observe(document,{childList:!0,subtree:!0});var k=a(5338),_=a(7664),N=a(1006),C=a(4350);a(6880);const x={single:"comment",uppercaseSingle:"COMMENT",ucfirstSingle:"Comment",ucfirstPlural:"Comments",submitCommentText:"SUBMIT",disabledCommentsMsg:"Comments are disabled"};function L(e){const t=(0,n.useRef)(null),[a,i]=(0,n.useState)(""),[l,s]=(0,n.useState)(!1),[d,c]=(0,n.useState)(!1),[u,m]=(0,n.useState)(-1),[h,g]=(0,n.useState)(""),[f]=(0,n.useState)(r.MemberContext._currentValue.is.anonymous?r.LinksContext._currentValue.signin+"?next=/"+window.location.href.replace(r.SiteContext._currentValue.url,"").replace(/^\//g,""):null);function v(){c(!0)}function y(){c(!1)}function b(){const e=[...o.MediaPageStore.get("users")],t=[];e.forEach((e=>{t.push({id:e.username,display:e.name})})),g(t)}function E(){t.current.style.height="";const e=t.current.scrollHeight,a=0<u?u:parseFloat(window.getComputedStyle(t.current).lineHeight);i(""),s(!1),m(a),t.current.style.height=Math.max(20,u*Math.ceil(e/a))+"px"}function S(){s(!1)}return(0,n.useEffect)((()=>(o.MediaPageStore.on("comment_submit",E),o.MediaPageStore.on("comment_submit_fail",S),!0===MediaCMS.features.media.actions.comment_mention&&o.MediaPageStore.on("users_load",b),()=>{o.MediaPageStore.removeListener("comment_submit",E),o.MediaPageStore.removeListener("comment_submit_fail",S),!0===MediaCMS.features.media.actions.comment_mention&&o.MediaPageStore.removeListener("users_load",b)}))),r.MemberContext._currentValue.is.anonymous?n.createElement("div",{className:"comments-form"},n.createElement("div",{className:"comments-form-inner"},n.createElement(_.UserThumbnail,null),n.createElement("div",{className:"form"},n.createElement("a",{href:f,rel:"noffolow",className:"form-textarea-wrap",title:"Add a "+x.single+"..."},n.createElement("span",{className:"form-textarea"},"Add a "+x.single+"...")),n.createElement("div",{className:"form-buttons"},n.createElement("a",{href:f,rel:"noffolow",className:"disabled"},x.submitCommentText))))):n.createElement("div",{className:"comments-form"},n.createElement("div",{className:"comments-form-inner"},n.createElement(_.UserThumbnail,null),n.createElement("div",{className:"form"},n.createElement("div",{className:"form-textarea-wrap"+(d?" focused":"")},MediaCMS.features.media.actions.comment_mention?n.createElement(N.G,{inputRef:t,className:"form-textarea",rows:"1",placeholder:"Add a "+x.single+"...",value:a,onChange:function(e,a,n,r){t.current.style.height="",i(a),s(!0);const o=t.current.scrollHeight,l=0<u?u:parseFloat(window.getComputedStyle(t.current).lineHeight);m(l),t.current.style.height=Math.max(20,u*Math.ceil(o/l))+"px"},onFocus:v,onBlur:y},n.createElement(N.P,{data:h,markup:"@(___id___)[___display___]"})):n.createElement("textarea",{ref:t,className:"form-textarea",rows:"1",placeholder:"Add a "+x.single+"...",value:a,onChange:function(e){t.current.style.height="";const a=t.current.scrollHeight,n=0<u?u:parseFloat(window.getComputedStyle(t.current).lineHeight);i(t.current.value),s(!0),m(n),t.current.style.height=Math.max(20,u*Math.ceil(a/n))+"px"},onFocus:v,onBlur:y})),n.createElement("div",{className:"form-buttons"},n.createElement("button",{className:""===a.trim()?"disabled":"",onClick:function(){if(!l)return;const e=a.trim();""!==e&&p.MediaPageActions.submitComment(e)}},x.submitCommentText)))))}L.propTypes={comment_type:d().oneOf(["new","reply"]),media_id:d().oneOfType([d().string,d().number]).isRequired,reply_comment_id:d().oneOfType([d().string,d().number])},L.defaultProps={comment_type:"new"};const V=!1;function A(e){const[t,a,i]=(0,k.usePopup)();return n.createElement("div",{className:"comment-actions"},r.MemberContext._currentValue.can.deleteComment?n.createElement("div",{className:"comment-action remove-comment"},n.createElement(i,{contentRef:t},n.createElement("button",null,"DELETE ",x.uppercaseSingle)),n.createElement(a,{contentRef:t},n.createElement(_.PopupMain,null,n.createElement("div",{className:"popup-message"},n.createElement("span",{className:"popup-message-title"},x.ucfirstSingle," removal"),n.createElement("span",{className:"popup-message-main"},"You're willing to remove ",x.single," permanently?")),n.createElement("hr",null),n.createElement("span",{className:"popup-message-bottom"},n.createElement("button",{className:"button-link cancel-comment-removal",onClick:function(){t.current.toggle()}},"CANCEL"),n.createElement("button",{className:"button-link proceed-comment-removal",onClick:function(){t.current.toggle(),p.MediaPageActions.deleteComment(e.comment_id)}},"PROCEED"))))):null)}function I(e){const t=(0,n.useRef)(null),a=(0,n.useRef)(null),[i,l]=(0,n.useState)(!V||!1),[s,d]=(0,n.useState)(!1);function c(){const e=s||a.offsetHeight>t.offsetHeight;d(e),l(e||!1)}return(0,n.useEffect)((()=>(V&&(o.PageStore.on("window_resize",c),d(a.offsetHeight>t.offsetHeight)),()=>{V&&o.PageStore.removeListener("window_resize",c)})),[]),n.createElement("div",{className:"comment"},n.createElement("div",{className:"comment-inner"},n.createElement("a",{className:"comment-author-thumb",href:e.author_link,title:e.author_name},n.createElement("img",{src:e.author_thumb,alt:e.author_name})),n.createElement("div",{className:"comment-content"},n.createElement("div",{className:"comment-meta"},n.createElement("div",{className:"comment-author"},n.createElement("a",{href:e.author_link,title:e.author_name},e.author_name)),n.createElement("div",{className:"comment-date"},(0,C.GP)(new Date(e.publish_date)))),n.createElement("div",{ref:t,className:"comment-text"+(i?" show-all":"")},n.createElement("div",{ref:a,className:"comment-text-inner",dangerouslySetInnerHTML:(u=e.text,{__html:u.replace(/\n/g,"<br />")})})),s?n.createElement("button",{className:"toggle-more",onClick:function(){l(!i)}},i?"Show less":"Read more"):null,r.MemberContext._currentValue.can.deleteComment?n.createElement(A,{comment_id:e.comment_id}):null)));var u}I.propTypes={comment_id:d().oneOfType([d().string,d().number]).isRequired,media_id:d().oneOfType([d().string,d().number]).isRequired,text:d().string,author_name:d().string,author_link:d().string,author_thumb:d().string,publish_date:d().oneOfType([d().string,d().number]),likes:d().number,dislikes:d().number},I.defaultProps={author_name:"",author_link:"#",publish_date:0,likes:0,dislikes:0};const T=({commentsLength:e})=>n.createElement(n.Fragment,null,!r.MemberContext._currentValue.can.readComment||o.MediaPageStore.get("media-data").enable_comments?null:n.createElement("span",{className:"disabled-comments-msg"},x.disabledCommentsMsg),r.MemberContext._currentValue.can.readComment&&(o.MediaPageStore.get("media-data").enable_comments||r.MemberContext._currentValue.can.editMedia)?n.createElement("h2",null,e?1<e?e+" "+x.ucfirstPlural:e+" "+x.ucfirstSingle:o.MediaPageStore.get("media-data").enable_comments?"No "+x.single+" yet":""):null);function R(e){const[t,a]=(0,n.useState)(o.MediaPageStore.get("media-id")),[i,l]=(0,n.useState)(r.MemberContext._currentValue.can.readComment?o.MediaPageStore.get("media-comments"):[]),[s,d]=(0,n.useState)(!1);function c(){const e=[...o.MediaPageStore.get("media-comments")];l([...e])}function u(e){c(),setTimeout((()=>p.PageActions.addNotification(x.ucfirstSingle+" added","commentSubmit")),100)}function m(){setTimeout((()=>p.PageActions.addNotification(x.ucfirstSingle+" submition failed","commentSubmitFail")),100)}function h(e){c(),setTimeout((()=>p.PageActions.addNotification(x.ucfirstSingle+" removed","commentDelete")),100)}function g(e){setTimeout((()=>p.PageActions.addNotification(x.ucfirstSingle+" removal failed","commentDeleteFail")),100)}return(0,n.useEffect)((()=>{d(i.length&&r.MemberContext._currentValue.can.readComment&&(o.MediaPageStore.get("media-data").enable_comments||r.MemberContext._currentValue.can.editMedia))}),[i]),(0,n.useEffect)((()=>(o.MediaPageStore.on("comments_load",c),o.MediaPageStore.on("comment_submit",u),o.MediaPageStore.on("comment_submit_fail",m),o.MediaPageStore.on("comment_delete",h),o.MediaPageStore.on("comment_delete_fail",g),()=>{o.MediaPageStore.removeListener("comments_load",c),o.MediaPageStore.removeListener("comment_submit",u),o.MediaPageStore.removeListener("comment_submit_fail",m),o.MediaPageStore.removeListener("comment_delete",h),o.MediaPageStore.removeListener("comment_delete_fail",g)})),[]),n.createElement("div",{className:"comments-list"},n.createElement("div",{className:"comments-list-inner"},n.createElement(T,{commentsLength:i.length}),o.MediaPageStore.get("media-data").enable_comments?n.createElement(L,{media_id:t}):null,s?i.map((e=>n.createElement(I,{key:e.uid,comment_id:e.uid,media_id:t,text:e.text,author_name:e.author_name,author_link:e.author_profile,author_thumb:r.SiteContext._currentValue.url+"/"+e.author_thumbnail_url.replace(/^\//g,""),publish_date:e.add_date,likes:0,dislikes:0}))):null))}var D=a(8974);function O(e){let t,a,i=[];if(e.length)for(t=0,a=1<e.length?", ":"";t<e.length;)i[t]=n.createElement("div",{key:t},n.createElement("a",{href:e[t].url,title:e[t].title},e[t].title),t<e.length-1?a:""),t+=1;return i}function U(e){return n.createElement("div",{className:"media-author-banner"},n.createElement("div",null,n.createElement("a",{className:"author-banner-thumb",href:e.link||null,title:e.name},n.createElement("span",{style:{backgroundImage:"url("+e.thumb+")"}},n.createElement("img",{src:e.thumb,loading:"lazy",alt:e.name,title:e.name})))),n.createElement("div",null,n.createElement("span",null,n.createElement("a",{href:e.link,className:"author-banner-name",title:e.name},n.createElement("span",null,e.name))),o.PageStore.get("config-media-item").displayPublishDate&&e.published?n.createElement("span",{className:"author-banner-date"},"Published on ",(0,m.publishedOnDate)(new Date(e.published))):null))}function q(e){return n.createElement("div",{className:e.id.trim()?"media-content-"+e.id.trim():null},n.createElement("div",{className:"media-content-field"},n.createElement("div",{className:"media-content-field-label"},n.createElement("h4",null,e.title)),n.createElement("div",{className:"media-content-field-content"},e.value)))}function j(e){let t=e.link;return window.MediaCMS.site.devEnv&&(t="/edit-media.html"),n.createElement("a",{href:t,rel:"nofollow",title:"Edit media",className:"edit-media"},"EDIT MEDIA")}function F(e){let t=e.link;return window.MediaCMS.site.devEnv&&(t="#"),n.createElement("a",{href:t,rel:"nofollow",title:"Edit subtitle",className:"edit-subtitle"},"EDIT SUBTITLE")}function H(e){const{userCan:t}=(0,k.useUser)(),a=e.description.trim(),i=!o.PageStore.get("config-enabled").taxonomies.tags||o.PageStore.get("config-enabled").taxonomies.tags.enabled?O(o.MediaPageStore.get("media-tags")):[],l=o.PageStore.get("config-options").pages.media.categoriesWithTitle?[]:!o.PageStore.get("config-enabled").taxonomies.categories||o.PageStore.get("config-enabled").taxonomies.categories.enabled?O(o.MediaPageStore.get("media-categories")):[];let s=o.MediaPageStore.get("media-summary");s=s?s.trim():"";const[d,c,u]=(0,k.usePopup)(),[h,g]=(0,n.useState)(""!==s),[f,v]=(0,n.useState)(""==s);function y(e){setTimeout((function(){p.PageActions.addNotification("Media removed. Redirecting...","mediaDelete"),setTimeout((function(){window.location.href=r.SiteContext._currentValue.url+"/"+o.MediaPageStore.get("media-data").author_profile.replace(/^\//g,"")}),2e3)}),100),void 0!==e&&D.info("Removed media '"+e+'"')}function b(e){setTimeout((function(){p.PageActions.addNotification("Media removal failed","mediaDeleteFail")}),100),void 0!==e&&D.info('Media "'+e+'" removal failed')}(0,n.useEffect)((()=>(o.MediaPageStore.on("media_delete",y),o.MediaPageStore.on("media_delete_fail",b),()=>{o.MediaPageStore.removeListener("media_delete",y),o.MediaPageStore.removeListener("media_delete_fail",b)})),[]);const E=(0,m.formatInnerLink)(e.author.url,r.SiteContext._currentValue.url),S=(0,m.formatInnerLink)(e.author.thumb,r.SiteContext._currentValue.url);return n.createElement("div",{className:"media-info-content"},void 0===o.PageStore.get("config-media-item").displayAuthor||null===o.PageStore.get("config-media-item").displayAuthor||o.PageStore.get("config-media-item").displayAuthor?n.createElement(U,{link:E,thumb:S,name:e.author.name,published:e.published}):null,n.createElement("div",{className:"media-content-banner"},n.createElement("div",{className:"media-content-banner-inner"},h?n.createElement("div",{className:"media-content-summary"},s):null,h&&!f||!a?null:o.PageStore.get("config-options").pages.media.htmlInDescription?n.createElement("div",{className:"media-content-description",dangerouslySetInnerHTML:{__html:a}}):n.createElement("div",{className:"media-content-description"},a),h?n.createElement("button",{className:"load-more",onClick:function(){v(!f)}},f?"SHOW LESS":"SHOW MORE"):null,i.length?n.createElement(q,{value:i,title:1<i.length?"Tags":"Tag",id:"tags"}):null,l.length?n.createElement(q,{value:l,title:1<l.length?"Categories":"Category",id:"categories"}):null,t.editMedia||t.editSubtitle||t.deleteMedia?n.createElement("div",{className:"media-author-actions"},t.editMedia?n.createElement(j,{link:o.MediaPageStore.get("media-data").edit_url}):null,t.editSubtitle&&"video"===o.MediaPageStore.get("media-data").media_type?n.createElement(F,{link:o.MediaPageStore.get("media-data").edit_url.replace("edit?","add_subtitle?")}):null,n.createElement(u,{contentRef:d},n.createElement("button",{className:"remove-media"},"DELETE MEDIA")),n.createElement(c,{contentRef:d},n.createElement(_.PopupMain,null,n.createElement("div",{className:"popup-message"},n.createElement("span",{className:"popup-message-title"},"Media removal"),n.createElement("span",{className:"popup-message-main"},"You're willing to remove media permanently?")),n.createElement("hr",null),n.createElement("span",{className:"popup-message-bottom"},n.createElement("button",{className:"button-link cancel-comment-removal",onClick:function(){d.current.toggle()}},"CANCEL"),n.createElement("button",{className:"button-link proceed-comment-removal",onClick:function(){p.MediaPageActions.removeMedia(),d.current.toggle()}},"PROCEED"))))):null)),n.createElement(R,null))}function z(){const[e,t]=(0,n.useState)(o.MediaPageStore.get("user-disliked-media")),[a,i]=(0,n.useState)((0,m.formatViewsNumber)(o.MediaPageStore.get("media-dislikes"),!1));function l(){t(o.MediaPageStore.get("user-disliked-media")),i((0,m.formatViewsNumber)(o.MediaPageStore.get("media-dislikes"),!1))}function s(){l(),p.PageActions.addNotification(r.TextsContext._currentValue.messages.addToDisliked,"mediaDislike")}function d(){l(),p.PageActions.addNotification(r.TextsContext._currentValue.messages.removeFromDisliked,"cancelMediaDislike")}function c(){p.PageActions.addNotification("Action failed","mediaDislikeRequestFail")}return(0,n.useEffect)((()=>(o.MediaPageStore.on("disliked_media",s),o.MediaPageStore.on("undisliked_media",d),o.MediaPageStore.on("disliked_media_failed_request",c),()=>{o.MediaPageStore.removeListener("disliked_media",s),o.MediaPageStore.removeListener("undisliked_media",d),o.MediaPageStore.removeListener("disliked_media_failed_request",c)})),[]),n.createElement("div",{className:"like"},n.createElement("button",{onClick:function(t){t.preventDefault(),t.stopPropagation(),p.MediaPageActions[e?"undislikeMedia":"dislikeMedia"]()}},n.createElement(_.CircleIconButton,{type:"span"},n.createElement(_.MaterialIcon,{type:"thumb_down"})),n.createElement("span",{className:"dislikes-counter"},a)))}function B(){const[e,t]=(0,n.useState)(o.MediaPageStore.get("user-liked-media")),[a,i]=(0,n.useState)((0,m.formatViewsNumber)(o.MediaPageStore.get("media-likes"),!1));function l(){t(o.MediaPageStore.get("user-liked-media")),i((0,m.formatViewsNumber)(o.MediaPageStore.get("media-likes"),!1))}function s(){l(),p.PageActions.addNotification(r.TextsContext._currentValue.addToLiked,"likedMedia")}function d(){l(),p.PageActions.addNotification(r.TextsContext._currentValue.removeFromLiked,"unlikedMedia")}function c(){p.PageActions.addNotification("Action failed","likedMediaRequestFail")}return(0,n.useEffect)((()=>(o.MediaPageStore.on("liked_media",s),o.MediaPageStore.on("unliked_media",d),o.MediaPageStore.on("liked_media_failed_request",c),()=>{o.MediaPageStore.removeListener("liked_media",s),o.MediaPageStore.removeListener("unliked_media",d),o.MediaPageStore.removeListener("liked_media_failed_request",c)})),[]),n.createElement("div",{className:"like"},n.createElement("button",{onClick:function(t){t.preventDefault(),t.stopPropagation(),p.MediaPageActions[e?"unlikeMedia":"likeMedia"]()}},n.createElement(_.CircleIconButton,{type:"span"},n.createElement(_.MaterialIcon,{type:"thumb_up"})),n.createElement("span",{className:"likes-counter"},a)))}function W(e){const t=(0,n.useRef)(null),a=(0,n.useRef)(null),[i,r]=(0,n.useState)(null);function l(){r(window.innerHeight-(104+t.current.offsetHeight))}return(0,n.useEffect)((()=>(l(),o.PageStore.on("window_resize",l),()=>{o.PageStore.removeListener("window_resize",l)})),[]),n.createElement("form",null,n.createElement("div",{className:"report-form",style:null!==i?{maxHeight:i+"px"}:null},n.createElement("div",{className:"form-title"},"Report media"),n.createElement("div",{className:"form-field"},n.createElement("span",{className:"label"},"URL"),n.createElement("input",{type:"text",readOnly:!0,value:e.mediaUrl})),n.createElement("div",{className:"form-field"},n.createElement("span",{className:"label"},"Description"),n.createElement("textarea",{ref:a,required:!0})),n.createElement("div",{className:"form-field form-help-text"},"Reported media is reviewed")),n.createElement("div",{ref:t,className:"form-actions-bottom"},n.createElement("button",{className:"cancel",onClick:function(t){t.preventDefault(),void 0!==e.cancelReportForm&&e.cancelReportForm()}},"CANCEL"),n.createElement("button",{onClick:function(t){const i=a.current.value.trim();""!==i&&(t.preventDefault(),void 0!==e.submitReportForm&&e.submitReportForm(i))}},"SUBMIT")))}function Q(e,t){const a=r.SiteContext._currentValue,i=e.encodings_info,n={};let o,l;for(o in i)if(i.hasOwnProperty(o)&&Object.keys(i[o]).length)for(l in i[o])i[o].hasOwnProperty(l)&&"success"===i[o][l].status&&100===i[o][l].progress&&null!==i[o][l].url&&(n[i[o][l].title]={text:o+" - "+l.toUpperCase()+" ("+i[o][l].size+")",link:(0,m.formatInnerLink)(i[o][l].url,a.url),linkAttr:{target:"_blank",download:e.title+"_"+o+"_"+l.toUpperCase()}});return n.original_media_url={text:"Original file ("+e.size+")",link:(0,m.formatInnerLink)(e.original_media_url,a.url),linkAttr:{target:"_blank",download:e.title}},Object.values(n)}function Y(e,t,a,i,r,o,l){const s=t.url,d=t.media_type,c=t.state||"N/A",u=t.encoding_status||"N/A",m=t.reported_times,p=t.is_reviewed,h="video"===d,g=function(e,t,a,i,n){const r=[],o="video"===t.media_type,l=t.reported_times;return a&&e.downloadMedia&&(o?r.push({itemType:"open-subpage",text:"Download",icon:"arrow_downward",itemAttr:{className:"visible-only-in-small"},buttonAttr:{className:"change-page","data-page-id":"videoDownloadOptions"}}):i&&r.push({itemType:"link",link:i,text:"Download",icon:"arrow_downward",itemAttr:{className:"visible-only-in-small"},linkAttr:{target:"_blank",download:t.title}})),o&&e.editMedia&&r.push({itemType:"open-subpage",text:"Status info",icon:"info",buttonAttr:{className:"change-page","data-page-id":"mediaStatusInfo"}}),e.reportMedia&&(n?r.push({itemType:"div",text:"Reported",icon:"flag",divAttr:{className:"reported-label loggedin-media-reported"}}):r.push({itemType:"open-subpage",text:"Report",icon:"flag",buttonAttr:{className:"change-page"+(l?" loggedin-media-reported":""),"data-page-id":"loggedInReportMedia"}})),r}(e,t,a,i,r),f={};return g.length&&(f.main=n.createElement("div",{className:"main-options"},n.createElement(_.PopupMain,null,n.createElement(_.NavigationMenuList,{items:g})))),e.reportMedia&&(f.loggedInReportMedia=r?null:n.createElement("div",{className:"popup-fullscreen"},n.createElement(_.PopupMain,null,n.createElement("span",{className:"popup-fullscreen-overlay"}),n.createElement("div",null,n.createElement(W,{mediaUrl:s,submitReportForm:o,cancelReportForm:l}))))),e.editMedia&&(f.mediaStatusInfo=n.createElement("div",{className:"main-options"},n.createElement(_.PopupMain,null,n.createElement("ul",{className:"media-status-info"},n.createElement("li",null,"Media type: ",n.createElement("span",null,d)),n.createElement("li",null,"State: ",n.createElement("span",null,c)),n.createElement("li",null,"Review state: ",n.createElement("span",null,p?"Is reviewed":"Pending review")),h?n.createElement("li",null,"Encoding Status: ",n.createElement("span",null,u)):null,m?n.createElement("li",{className:"reports"},"Reports: ",n.createElement("span",null,m)):null)))),a&&e.downloadMedia&&h&&(f.videoDownloadOptions=n.createElement("div",{className:"video-download-options"},n.createElement(_.PopupMain,null,n.createElement(_.NavigationMenuList,{items:Q(t)})))),f}W.propTypes={mediaUrl:d().string.isRequired,cancelReportForm:d().func,submitReportForm:d().func};const G="more-options active-options";function Z(e){const{userCan:t}=(0,k.useUser)(),a=r.SiteContext._currentValue,i=(0,m.formatInnerLink)(o.MediaPageStore.get("media-original-url"),a.url),l=o.MediaPageStore.get("media-data"),s="video"===l.media_type,[d,c,u]=(0,k.usePopup)(),[h,g]=(0,n.useState)(!1),[f,v]=(0,n.useState)(!1),[y,b]=(0,n.useState)({}),[E,S]=(0,n.useState)("main"),[P,M]=(0,n.useState)(G);function w(e){p.MediaPageActions.reportMedia(e)}function N(){d.current.toggle()}function C(){d.current.tryToHide(),setTimeout((function(){p.PageActions.addNotification("Media Reported","reportedMedia"),v(!0),o.MediaPageStore.removeListener("reported_media",C)}),100)}return(0,n.useEffect)((()=>{f||(h?o.MediaPageStore.on("reported_media",C):o.MediaPageStore.removeListener("reported_media",C))}),[h]),(0,n.useEffect)((()=>{g(Object.keys(y).length&&e.allowDownload&&t.downloadMedia)}),[y]),(0,n.useEffect)((()=>{let a=G;e.allowDownload&&t.downloadMedia&&"videoDownloadOptions"===E&&(a+=" video-downloads"),1===Object.keys(y).length&&e.allowDownload&&t.downloadMedia&&(s||i)&&(a+=" visible-only-in-small"),M(a)}),[E]),(0,n.useEffect)((()=>{b(Y(t,l,e.allowDownload,i,f,w,N))}),[f]),(0,n.useEffect)((()=>(b(Y(t,l,e.allowDownload,i,f,w,N)),()=>{h&&!f&&o.MediaPageStore.removeListener("reported_media",C)})),[]),h?n.createElement("div",{className:P},n.createElement(u,{contentRef:d},n.createElement("span",null,n.createElement(_.CircleIconButton,{type:"button"},n.createElement(_.MaterialIcon,{type:"more_horiz"})))),n.createElement("div",{className:"nav-page-"+E},n.createElement(c,{contentRef:d,hideCallback:function(){S("main")}},n.createElement(_.NavigationContentApp,{pageChangeCallback:function(e){S(e)},initPage:E,focusFirstItemOnPageChange:!1,pages:y,pageChangeSelector:".change-page",pageIdSelectorAttr:"data-page-id"})))):null}Z.propTypes={allowDownload:d().bool.isRequired},Z.defaultProps={allowDownload:!1};var J=a(3706);function K(e){return e.renderDate?n.createElement("label",null,n.createElement("input",{type:"checkbox",checked:e.isChecked,onChange:function(t){t.persist(),e.isChecked?p.MediaPageActions.removeMediaFromPlaylist(e.playlistId,o.MediaPageStore.get("media-id")):p.MediaPageActions.addMediaToPlaylist(e.playlistId,o.MediaPageStore.get("media-id"))}}),n.createElement("span",null,e.title)):null}function $(e){const t=(0,n.useRef)(null),a=(0,n.useRef)(null),[i,r]=(0,n.useState)(new Date),[l,s]=(0,n.useState)(o.MediaPageStore.get("playlists")),[d,c]=(0,n.useState)(!1);function u(){y()}function m(){s(o.MediaPageStore.get("playlists")),r(new Date)}function h(){s(o.MediaPageStore.get("playlists")),r(new Date),setTimeout((function(){p.PageActions.addNotification("Media added to playlist","playlistMediaAdditionComplete")}),100)}function g(){setTimeout((function(){p.PageActions.addNotification("Media's addition to playlist failed","playlistMediaAdditionFail")}),100)}function f(){s(o.MediaPageStore.get("playlists")),r(new Date),setTimeout((function(){p.PageActions.addNotification("Media removed from playlist","playlistMediaRemovalComplete")}),100)}function v(){setTimeout((function(){p.PageActions.addNotification("Media's removal from playlist failed","playlistMediaaRemovalFail")}),100)}function y(){null!==a.current&&(a.current.style.maxHeight=window.innerHeight-74-(t.current.offsetHeight-a.current.offsetHeight)+"px")}function b(){c(!d),y()}return(0,n.useEffect)((()=>{y()})),(0,n.useEffect)((()=>(o.PageStore.on("window_resize",u),o.MediaPageStore.on("playlists_load",m),o.MediaPageStore.on("media_playlist_addition_completed",h),o.MediaPageStore.on("media_playlist_addition_failed",g),o.MediaPageStore.on("media_playlist_removal_completed",f),o.MediaPageStore.on("media_playlist_removal_failed",v),()=>{o.PageStore.removeListener("window_resize",u),o.MediaPageStore.removeListener("playlists_load",m),o.MediaPageStore.removeListener("media_playlist_addition_completed",h),o.MediaPageStore.removeListener("media_playlist_addition_failed",g),o.MediaPageStore.removeListener("media_playlist_removal_completed",f),o.MediaPageStore.removeListener("media_playlist_removal_failed",v)})),[]),n.createElement("div",{ref:t,className:"saveto-popup"},n.createElement("div",{className:"saveto-title"},"Save to...",n.createElement(_.CircleIconButton,{type:"button",onClick:function(){c(!1),void 0!==e.triggerPopupClose&&e.triggerPopupClose()}},n.createElement(_.MaterialIcon,{type:"close"}))),l.length?n.createElement("div",{ref:a,className:"saveto-select"},function(){const e=o.MediaPageStore.get("media-id");let t=[],a=0;for(;a<l.length;)t.push(n.createElement("div",{key:"playlist_"+l[a].playlist_id},n.createElement(K,{renderDate:i,title:l[a].title,privacy:l[a].status,isChecked:-1<l[a].media_list.indexOf(e),playlistId:l[a].playlist_id}))),a+=1;return t}()):null,d?n.createElement("div",{className:"saveto-new-playlist"},n.createElement(J.w,{onCancel:b,onPlaylistSave:function(e){p.MediaPageActions.addNewPlaylist(e),b()}})):n.createElement(_.CircleIconButton,{className:"saveto-create",type:"button",onClick:b},n.createElement(_.MaterialIcon,{type:"add"}),"Create a new playlist"))}function X(e){const[t,a,i]=(0,k.usePopup)(),[r,o]=(0,n.useState)("selectPlaylist");return n.createElement("div",{className:"save"},n.createElement(i,{contentRef:t},n.createElement("button",null,n.createElement(_.CircleIconButton,{type:"span"},n.createElement(_.MaterialIcon,{type:"playlist_add"})),n.createElement("span",null,"SAVE"))),n.createElement(a,{contentRef:t},n.createElement(_.NavigationContentApp,{initPage:r,pageChangeSelector:".change-page",pageIdSelectorAttr:"data-page-id",pages:(l=function(){t.current.toggle()},{selectPlaylist:n.createElement("div",{className:"popup-fullscreen"},n.createElement(_.PopupMain,null,n.createElement("span",{className:"popup-fullscreen-overlay"}),n.createElement($,{triggerPopupClose:l}))),createPlaylist:n.createElement("div",{className:"popup-fullscreen"},n.createElement(_.PopupMain,null,n.createElement("span",{className:"popup-fullscreen-overlay"})))}),focusFirstItemOnPageChange:!1,pageChangeCallback:o})));var l}function ee(e){const t=o.PageStore.get("config-options").embedded.video.dimensions,a=(0,n.useContext)(r.LinksContext),i=(0,n.useRef)(null),l=(0,n.useRef)(null),s=(0,n.useRef)(null),d=(0,n.useRef)(null),c=(0,n.useRef)(null),[u,m]=(0,n.useState)(window.innerHeight-144+56),[h,g]=(0,n.useState)(!1),[f,v]=(0,n.useState)("16:9"),[y,b]=(0,n.useState)(t.width),[E,S]=(0,n.useState)(t.widthUnit),[P,w]=(0,n.useState)(t.height),[k,N]=(0,n.useState)(t.heightUnit),[C,x]=(0,n.useState)(60),[L,V]=(0,n.useState)(60),[A,I]=(0,n.useState)([{key:"px",label:"px"},{key:"percent",label:"%"}]);function T(){m(window.innerHeight-144+56),x(s.current.offsetHeight),V(c.current.offsetHeight)}function R(){setTimeout((function(){p.PageActions.addNotification("Embed media code copied to clipboard","clipboardEmbedMediaCodeCopy")}),100)}return(0,n.useEffect)((()=>{m(window.innerHeight-144+56),x(s.current.offsetHeight),V(c.current.offsetHeight)})),(0,n.useEffect)((()=>(o.PageStore.on("window_resize",T),o.MediaPageStore.on("copied_embed_media_code",R),()=>{o.PageStore.removeListener("window_resize",T),o.MediaPageStore.removeListener("copied_embed_media_code",R)})),[]),n.createElement("div",{className:"share-embed",style:{maxHeight:u+"px"}},n.createElement("div",{className:"share-embed-inner"},n.createElement("div",{className:"on-left"},n.createElement("div",{className:"media-embed-wrap"},n.createElement(M,{data:o.MediaPageStore.get("media-data"),inEmbed:!0}))),n.createElement("div",{ref:l,className:"on-right"},n.createElement("div",{ref:s,className:"on-right-top"},n.createElement("div",{className:"on-right-top-inner"},n.createElement("span",{className:"ttl"},"Embed Video"),n.createElement(_.CircleIconButton,{type:"button",onClick:function(){void 0!==e.triggerPopupClose&&e.triggerPopupClose()}},n.createElement(_.MaterialIcon,{type:"close"})))),n.createElement("div",{ref:d,className:"on-right-middle",style:{top:C+"px",bottom:L+"px"}},n.createElement("textarea",{readOnly:!0,value:'<iframe width="'+("percent"===E?y+"%":y)+'" height="'+("percent"===k?P+"%":P)+'" src="'+a.embed+o.MediaPageStore.get("media-id")+'" frameborder="0" allowfullscreen></iframe>'}),n.createElement("div",{className:"iframe-config"},n.createElement("div",{className:"iframe-config-options-title"},"Embed options"),n.createElement("div",{className:"iframe-config-option"},n.createElement("div",{className:"option-content"},n.createElement("div",{className:"ratio-options"},n.createElement("div",{className:"options-group"},n.createElement("label",{style:{minHeight:"36px"}},n.createElement("input",{type:"checkbox",checked:h,onChange:function(){const e=!h,t=f.split(":"),a=t[0],i=t[1];g(e),S(e?"px":E),N(e?"px":k),w(e?parseInt(y*i/a,10):P),I(e?[{key:"px",label:"px"}]:[{key:"px",label:"px"},{key:"percent",label:"%"}])}}),"Keep aspect ratio")),h?n.createElement("div",{className:"options-group"},n.createElement("select",{ref:i,onChange:function(){const e=i.current.value,t=e.split(":"),a=t[0],n=t[1];v(e),w(h?parseInt(y*n/a,10):P)},value:f},n.createElement("optgroup",{label:"Horizontal orientation"},n.createElement("option",{value:"16:9"},"16:9"),n.createElement("option",{value:"4:3"},"4:3"),n.createElement("option",{value:"3:2"},"3:2")),n.createElement("optgroup",{label:"Vertical orientation"},n.createElement("option",{value:"9:16"},"9:16"),n.createElement("option",{value:"3:4"},"3:4"),n.createElement("option",{value:"2:3"},"2:3")))):null),n.createElement("br",null),n.createElement("div",{className:"options-group"},n.createElement(_.NumericInputWithUnit,{valueCallback:function(e){e=""===e?0:e;const t=f.split(":"),a=t[0],i=t[1];b(e),w(h?parseInt(e*i/a,10):P)},unitCallback:function(e){S(e)},label:"Width",defaultValue:parseInt(y,10),defaultUnit:E,minValue:1,maxValue:99999,units:A})),n.createElement("div",{className:"options-group"},n.createElement(_.NumericInputWithUnit,{valueCallback:function(e){e=""===e?0:e;const t=f.split(":"),a=t[0],i=t[1];w(e),b(h?parseInt(e*a/i,10):y)},unitCallback:function(e){N(e)},label:"Height",defaultValue:parseInt(P,10),defaultUnit:k,minValue:1,maxValue:99999,units:A})))))),n.createElement("div",{ref:c,className:"on-right-bottom"},n.createElement("button",{onClick:function(){p.MediaPageActions.copyEmbedMediaCode(d.current.querySelector("textarea"))}},"COPY")))))}K.propTypes={playlistId:d().string,isChecked:d().bool,title:d().string},K.defaultProps={isChecked:!1,title:""},$.propTypes={triggerPopupClose:d().func},ee.propTypes={triggerPopupClose:d().func};var te=a(5289);function ae({onClick:e}){return n.createElement("span",{className:"next-slide"},n.createElement(_.CircleIconButton,{buttonShadow:!0,onClick:e},n.createElement("i",{className:"material-icons"},"keyboard_arrow_right")))}function ie({onClick:e}){return n.createElement("span",{className:"previous-slide"},n.createElement(_.CircleIconButton,{buttonShadow:!0,onClick:e},n.createElement("i",{className:"material-icons"},"keyboard_arrow_left")))}function ne(){return{maxFormContentHeight:window.innerHeight-196,maxPopupWidth:518>window.innerWidth-80?window.innerWidth-80:null}}function re(e){const t=(0,n.useRef)(null),a=(0,n.useRef)(null),i=o.MediaPageStore.get("media-url"),[l,s]=(0,n.useState)(null),[d,c]=(0,n.useState)({prev:!1,next:!1}),[u,m]=(0,n.useState)(ne()),[h]=(0,n.useState)(function(){const e=function(){const e=r.ShareOptionsContext._currentValue,t=o.MediaPageStore.get("media-url"),a=o.MediaPageStore.get("media-data").title,i={};let n=0;for(;n<e.length;){switch(e[n]){case"embed":"video"===o.MediaPageStore.get("media-data").media_type&&(i[e[n]]={});break;case"email":i[e[n]]={title:"Email",shareUrl:"mailto:?body="+t};break;case"fb":i[e[n]]={title:"Facebook",shareUrl:"https://www.facebook.com/sharer.php?u="+t};break;case"tw":i[e[n]]={title:"Twitter",shareUrl:"https://twitter.com/intent/tweet?url="+t};break;case"reddit":i[e[n]]={title:"reddit",shareUrl:"https://reddit.com/submit?url="+t+"&title="+a};break;case"tumblr":i[e[n]]={title:"Tumblr",shareUrl:"https://www.tumblr.com/widgets/share/tool?canonicalUrl="+t+"&title="+a};break;case"pinterest":i[e[n]]={title:"Pinterest",shareUrl:"http://pinterest.com/pin/create/link/?url="+t};break;case"vk":i[e[n]]={title:"ВКонтакте",shareUrl:"http://vk.com/share.php?url="+t+"&title="+a};break;case"linkedin":i[e[n]]={title:"LinkedIn",shareUrl:"https://www.linkedin.com/shareArticle?mini=true&url="+t};break;case"mix":i[e[n]]={title:"Mix",shareUrl:"https://mix.com/add?url="+t};break;case"whatsapp":i[e[n]]={title:"WhatsApp",shareUrl:"whatsapp://send?text="+t};break;case"telegram":i[e[n]]={title:"Telegram",shareUrl:"https://t.me/share/url?url="+t+"&text="+a}}n+=1}return i}(),t=[];for(let a in e)e.hasOwnProperty(a)&&("embed"===a?t.push(n.createElement("div",{key:"share-"+a,className:"sh-option share-"+a+"-opt"},n.createElement("button",{className:"sh-option change-page","data-page-id":"shareEmbed"},n.createElement("span",null,n.createElement("i",{className:"material-icons"},"code")),n.createElement("span",null,"Embed")))):"whatsapp"===a?t.push(n.createElement("div",{key:"share-"+a,className:"sh-option share-"+a},n.createElement("a",{href:e[a].shareUrl,title:"",target:"_blank","data-action":"share/whatsapp/share",rel:"noreferrer"},n.createElement("span",null),n.createElement("span",null,e[a].title)))):"email"===a?t.push(n.createElement("div",{key:"share-email",className:"sh-option share-email"},n.createElement("a",{href:e[a].shareUrl,title:""},n.createElement("span",null,n.createElement("i",{className:"material-icons"},"email")),n.createElement("span",null,e[a].title)))):t.push(n.createElement("div",{key:"share-"+a,className:"sh-option share-"+a},n.createElement("a",{href:e[a].shareUrl,title:"",target:"_blank",rel:"noreferrer"},n.createElement("span",null),n.createElement("span",null,e[a].title)))));return t}()),[g,f]=(0,n.useState)(0),[v,y]=(0,n.useState)(0),[b,E]=(0,n.useState)(!1),[S,P]=(0,n.useState)(i);function M(){m(ne())}function w(){setTimeout((function(){p.PageActions.addNotification("Link copied to clipboard","clipboardLinkCopy")}),100)}function k(){l.scrollToCurrentSlide(),c({prev:l.hasPreviousSlide(),next:l.hasNextSlide()})}return(0,n.useEffect)((()=>{s(new te.A(a.current,".sh-option"))}),[h]),(0,n.useEffect)((()=>{l&&(l.updateDataStateOnResize(h.length,!0,!0),k())}),[u,l]),(0,n.useEffect)((()=>{o.PageStore.on("window_resize",M),o.MediaPageStore.on("copied_media_link",w);const e=null===(t=document.getElementsByTagName("video")[0])||void 0===t?void 0:t.currentTime;var t;return f(e),y(function(e){let t=parseInt(e,10),a=Math.floor(t/3600),i=Math.floor((t-3600*a)/60),n=t-3600*a-60*i;return a<10&&(a="0"+a),i<10&&(i="0"+i),n<10&&(n="0"+n),a>=1?a+":"+i+":"+n:i+":"+n}(e)),()=>{o.PageStore.removeListener("window_resize",M),o.MediaPageStore.removeListener("copied_media_link",w),s(null)}}),[]),n.createElement("div",{ref:t,style:null!==u.maxPopupWidth?{maxWidth:u.maxPopupWidth+"px"}:null},n.createElement("div",{className:"scrollable-content",style:null!==u.maxFormContentHeight?{maxHeight:u.maxFormContentHeight+"px"}:null},n.createElement("div",{className:"share-popup-title"},"Share media"),h.length?n.createElement("div",{className:"share-options"},d.prev?n.createElement(ie,{onClick:function(){l.previousSlide(),k()}}):null,n.createElement("div",{ref:a,className:"share-options-inner"},h),d.next?n.createElement(ae,{onClick:function(){l.nextSlide(),k()}}):null):null),n.createElement("div",{className:"copy-field"},n.createElement("div",null,n.createElement("input",{type:"text",readOnly:!0,value:S}),n.createElement("button",{onClick:function(){p.MediaPageActions.copyShareLink(t.current.querySelector(".copy-field input"))}},"COPY"))),n.createElement("div",{className:"start-at"},n.createElement("label",null,n.createElement("input",{type:"checkbox",name:"start-at-checkbox",id:"id-start-at-checkbox",checked:b,onChange:function(){E(!b),function(){const e=b?i:i+"&t="+Math.trunc(g);P(e)}()}}),"Start at ",v)))}function oe(){return{shareOptions:n.createElement("div",{className:"popup-fullscreen"},n.createElement(_.PopupMain,null,n.createElement("span",{className:"popup-fullscreen-overlay"}),n.createElement(re,null)))}}function le(e){const[t,a,i]=(0,k.usePopup)(),[r,o]=(0,n.useState)("shareOptions");return n.createElement("div",{className:"share"},n.createElement(i,{contentRef:t},n.createElement("button",null,n.createElement(_.CircleIconButton,{type:"span"},n.createElement(_.MaterialIcon,{type:"share"})),n.createElement("span",null,"SHARE"))),n.createElement(a,{contentRef:t,hideCallback:function(){o("shareOptions")}},n.createElement(_.NavigationContentApp,{initPage:r,pageChangeSelector:".change-page",pageIdSelectorAttr:"data-page-id",pages:e.isVideo?(l=function(){t.current.toggle()},{...oe(),shareEmbed:n.createElement("div",{className:"popup-fullscreen share-embed-popup"},n.createElement(_.PopupMain,null,n.createElement("span",{className:"popup-fullscreen-overlay"}),n.createElement(ee,{triggerPopupClose:l})))}):oe(),focusFirstItemOnPageChange:!1,pageChangeCallback:function(e){o(e)}})));var l}function se(e){return n.createElement("div",{className:"download hidden-only-in-small"},n.createElement("a",{href:e.link,target:"_blank",download:e.title,title:"Download",rel:"noreferrer"},n.createElement(_.CircleIconButton,{type:"span"},n.createElement(_.MaterialIcon,{type:"arrow_downward"})),n.createElement("span",null,"DOWNLOAD")))}function de(){const e=o.MediaPageStore.get("media-data"),t=(e.title,e.encodings_info),a={};let i,n;for(i in t)if(t.hasOwnProperty(i)&&Object.keys(t[i]).length)for(n in t[i])t[i].hasOwnProperty(n)&&"success"===t[i][n].status&&100===t[i][n].progress&&null!==t[i][n].url&&(a[t[i][n].title]={text:i+" - "+n.toUpperCase()+" ("+t[i][n].size+")",link:(0,m.formatInnerLink)(t[i][n].url,r.SiteContext._currentValue.url),linkAttr:{target:"_blank",download:e.title+"_"+i+"_"+n.toUpperCase()}});return a.original_media_url={text:"Original file ("+e.size+")",link:(0,m.formatInnerLink)(e.original_media_url,r.SiteContext._currentValue.url),linkAttr:{target:"_blank",download:e.title}},Object.values(a)}function ce(e){const[t,a,i]=(0,k.usePopup)(),[r,o]=(0,n.useState)("main");return n.createElement("div",{className:"video-downloads hidden-only-in-small"},n.createElement(i,{contentRef:t},n.createElement("button",null,n.createElement(_.CircleIconButton,{type:"span"},n.createElement(_.MaterialIcon,{type:"arrow_downward"})),n.createElement("span",null,"DOWNLOAD"))),n.createElement("div",{className:"nav-page-"+r},n.createElement(a,{contentRef:t},n.createElement(_.NavigationContentApp,{pageChangeCallback:null,initPage:"main",focusFirstItemOnPageChange:!1,pages:{main:n.createElement("div",{className:"main-options"},n.createElement(_.PopupMain,null,n.createElement(_.NavigationMenuList,{items:de()})))},pageChangeSelector:".change-page",pageIdSelectorAttr:"data-page-id"}))))}se.propTypes={link:d().string.isRequired,title:d().string.isRequired};class ue extends n.PureComponent{constructor(e){super(e),this.state={likedMedia:o.MediaPageStore.get("user-liked-media"),dislikedMedia:o.MediaPageStore.get("user-disliked-media")},this.downloadLink="video"!==o.MediaPageStore.get("media-type")?(0,m.formatInnerLink)(o.MediaPageStore.get("media-original-url"),r.SiteContext._currentValue.url):null,this.updateStateValues=this.updateStateValues.bind(this)}componentDidMount(){o.MediaPageStore.on("liked_media",this.updateStateValues),o.MediaPageStore.on("unliked_media",this.updateStateValues),o.MediaPageStore.on("disliked_media",this.updateStateValues),o.MediaPageStore.on("undisliked_media",this.updateStateValues);const e=document.querySelectorAll("[data-tooltip]");e.length&&e.forEach((e=>function(e){const t=document.body,a=document.createElement("span");function i(){const t=e.getBoundingClientRect();a.style.top=t.top-(0+a.offsetHeight)+"px",a.style.left=t.left+"px"}a.innerText=e.getAttribute("data-tooltip"),a.setAttribute("class","tooltip"),e.removeAttribute("data-tooltip"),e.addEventListener("mouseenter",(function(){const n=e.getBoundingClientRect();t.appendChild(a),a.style.top=n.top-(0+a.offsetHeight)+"px",a.style.left=n.left+"px",document.addEventListener("scroll",i)})),e.addEventListener("mouseleave",(function(){t.removeChild(a),a.style.top="",a.style.left="",document.removeEventListener("scroll",i)}))}(e)))}updateStateValues(){this.setState({likedMedia:o.MediaPageStore.get("user-liked-media"),dislikedMedia:o.MediaPageStore.get("user-disliked-media")})}mediaCategories(e){if(void 0===this.props.categories||null===this.props.categories||!this.props.categories.length)return null;let t=0,a=[];for(;t<this.props.categories.length;)a.push(n.createElement("span",{key:t},n.createElement("a",{href:(0,m.formatInnerLink)(this.props.categories[t].url,r.SiteContext._currentValue.url),title:this.props.categories[t].title},this.props.categories[t].title))),t+=1;return n.createElement("div",{className:"media-under-title-categories"+(e?" over-title":"")},a)}render(){const e=o.PageStore.get("config-options").pages.media.displayViews&&void 0!==this.props.views,t=o.MediaPageStore.get("media-data").state;let a="";switch(t){case"private":a="The site admins have to make its access public";break;case"unlisted":a="The site admins have to make it appear on listings"}return n.createElement("div",{className:"media-title-banner"},e&&o.PageStore.get("config-options").pages.media.categoriesWithTitle?this.mediaCategories(!0):null,void 0!==this.props.title?n.createElement("h1",null,this.props.title):null,"public"!==t?n.createElement("div",{className:"media-labels-area"},n.createElement("div",{className:"media-labels-area-inner"},n.createElement("span",{className:"media-label-state"},n.createElement("span",null,t)),n.createElement("span",{className:"helper-icon","data-tooltip":a},n.createElement("i",{className:"material-icons"},"help_outline")))):null,n.createElement("div",{className:"media-views-actions"+(this.state.likedMedia?" liked-media":"")+(this.state.dislikedMedia?" disliked-media":"")},!e&&o.PageStore.get("config-options").pages.media.categoriesWithTitle?this.mediaCategories():null,e?n.createElement("div",{className:"media-views"},(0,m.formatViewsNumber)(this.props.views,!0)," ",1>=this.props.views?"view":"views"):null,n.createElement("div",{className:"media-actions"},n.createElement("div",null,r.MemberContext._currentValue.can.likeMedia?n.createElement(B,null):null,r.MemberContext._currentValue.can.dislikeMedia?n.createElement(z,null):null,r.MemberContext._currentValue.can.shareMedia?n.createElement(le,{isVideo:!1}):null,!r.MemberContext._currentValue.is.anonymous&&r.MemberContext._currentValue.can.saveMedia&&-1<r.PlaylistsContext._currentValue.mediaTypes.indexOf(o.MediaPageStore.get("media-type"))?n.createElement(X,null):null,this.props.allowDownload&&r.MemberContext._currentValue.can.downloadMedia?this.downloadLink?n.createElement(se,{link:this.downloadLink,title:this.props.title}):n.createElement(ce,null):null,n.createElement(Z,{allowDownload:this.props.allowDownload})))))}}ue.propTypes={allowDownload:d().bool.isRequired},ue.defaultProps={allowDownload:!1};class me extends ue{render(){const e=o.PageStore.get("config-options").pages.media.displayViews&&void 0!==this.props.views,t=o.MediaPageStore.get("media-data").state;let a="";switch(t){case"private":a="The site admins have to make its access public";break;case"unlisted":a="The site admins have to make it appear on listings"}return n.createElement("div",{className:"media-title-banner"},e&&o.PageStore.get("config-options").pages.media.categoriesWithTitle?this.mediaCategories(!0):null,void 0!==this.props.title?n.createElement("h1",null,this.props.title):null,"public"!==t?n.createElement("div",{className:"media-labels-area"},n.createElement("div",{className:"media-labels-area-inner"},n.createElement("span",{className:"media-label-state"},n.createElement("span",null,t)),n.createElement("span",{className:"helper-icon","data-tooltip":a},n.createElement("i",{className:"material-icons"},"help_outline")))):null,n.createElement("div",{className:"media-views-actions"+(this.state.likedMedia?" liked-media":"")+(this.state.dislikedMedia?" disliked-media":"")},!e&&o.PageStore.get("config-options").pages.media.categoriesWithTitle?this.mediaCategories():null,e?n.createElement("div",{className:"media-views"},(0,m.formatViewsNumber)(this.props.views,!0)," ",1>=this.props.views?"view":"views"):null,n.createElement("div",{className:"media-actions"},n.createElement("div",null,r.MemberContext._currentValue.can.likeMedia?n.createElement(B,null):null,r.MemberContext._currentValue.can.dislikeMedia?n.createElement(z,null):null,r.MemberContext._currentValue.can.shareMedia?n.createElement(le,{isVideo:!0}):null,!r.MemberContext._currentValue.is.anonymous&&r.MemberContext._currentValue.can.saveMedia&&-1<r.PlaylistsContext._currentValue.mediaTypes.indexOf(o.MediaPageStore.get("media-type"))?n.createElement(X,null):null,this.props.allowDownload&&r.MemberContext._currentValue.can.downloadMedia?this.downloadLink?n.createElement(se,{link:this.downloadLink,title:this.props.title}):n.createElement(ce,null):null,n.createElement(Z,{allowDownload:this.props.allowDownload})))))}}class pe extends n.PureComponent{constructor(e){super(e),this.state={videoLoaded:!1},this.onVideoLoad=this.onVideoLoad.bind(this),o.MediaPageStore.on("loaded_media_data",this.onVideoLoad)}onVideoLoad(){this.setState({videoLoaded:!0})}render(){let e,t,a,i,r,l,s=!1;return this.state.videoLoaded&&(s=o.MediaPageStore.get("media-data").allow_download,s=void 0===s||!!s,e=o.MediaPageStore.get("media-data").views,t=o.MediaPageStore.get("media-data").categories_info,a=o.MediaPageStore.get("media-data").title,i={name:o.MediaPageStore.get("media-data").author_name,url:o.MediaPageStore.get("media-data").author_profile,thumb:o.MediaPageStore.get("media-author-thumbnail-url")},r=o.MediaPageStore.get("media-data").add_date,l=o.MediaPageStore.get("media-data").description),this.state.videoLoaded?n.createElement("div",{className:"viewer-info"},n.createElement("div",{className:"viewer-info-inner"},n.createElement(ue,{title:a,views:e,categories:t,allowDownload:s}),n.createElement(H,{author:i,published:r,description:l}))):null}}class he extends pe{render(){let e,t,a,i,r,l,s=!1;return this.state.videoLoaded&&(s=o.MediaPageStore.get("media-data").allow_download,s=void 0===s||!!s,e=o.MediaPageStore.get("media-data").views,t=o.MediaPageStore.get("media-data").categories_info,a=o.MediaPageStore.get("media-data").title,i={name:o.MediaPageStore.get("media-data").author_name,url:o.MediaPageStore.get("media-data").author_profile,thumb:o.MediaPageStore.get("media-author-thumbnail-url")},r=o.MediaPageStore.get("media-data").add_date,l=o.MediaPageStore.get("media-data").description),this.state.videoLoaded?n.createElement("div",{className:"viewer-info"},n.createElement("div",{className:"viewer-info-inner"},n.createElement(me,{title:a,views:e,categories:t,allowDownload:s}),n.createElement(H,{author:i,published:r,description:l}))):null}}class ge extends n.PureComponent{render(){return n.createElement("div",{className:"viewer-container",key:"viewer-container-error"},n.createElement("div",{className:"player-container player-container-error"},n.createElement("div",{className:"player-container-inner"},n.createElement("div",{className:"error-container"},n.createElement("div",{className:"error-container-inner"},n.createElement("span",{className:"icon-wrap"},n.createElement("i",{className:"material-icons"},"error_outline")),n.createElement("span",{className:"msg-wrap"},o.MediaPageStore.get("media-load-error-message")))))))}}var fe=a(4737);function ve(){const e=o.MediaPageStore.get("media-data");return e&&e.related_media&&e.related_media.length?e.related_media[0]:null}function ye(e){const[t,a]=(0,n.useState)(ve()),[i,r]=(0,n.useState)(o.PageStore.get("media-auto-play"));function l(){r(o.PageStore.get("media-auto-play"))}function s(){a(ve())}return(0,n.useEffect)((()=>(o.MediaPageStore.on("loaded_media_data",s),o.PageStore.on("switched_media_auto_play",l),()=>{o.MediaPageStore.removeListener("loaded_media_data",s),o.PageStore.removeListener("switched_media_auto_play",l)})),[]),t?n.createElement("div",{className:"auto-play"},n.createElement("div",{className:"auto-play-header"},n.createElement("div",{className:"next-label"},"Up next"),n.createElement("div",{className:"auto-play-option"},n.createElement("label",{className:"checkbox-label right-selectbox",tabIndex:0,onKeyPress:function(e){0===e.keyCode&&p.PageActions.toggleMediaAutoPlay()}},"AUTOPLAY",n.createElement("span",{className:"checkbox-switcher-wrap"},n.createElement("span",{className:"checkbox-switcher"},n.createElement("input",{type:"checkbox",tabIndex:-1,checked:i,onChange:p.PageActions.toggleMediaAutoPlay})))))),n.createElement(fe.k,{className:"items-list-hor",items:[t],pageItems:1,maxItems:1,singleLinkContent:!0,horizontalItemsOrientation:!0,hideDate:!0,hideViews:!o.PageStore.get("config-media-item").displayViews,hideAuthor:!o.PageStore.get("config-media-item").displayAuthor})):null}function be(e){const[t,a]=(0,n.useState)(s()),[i,r]=(0,n.useState)(null);function l(){r(o.MediaPageStore.get("media-type")),a(s())}function s(){const e=o.MediaPageStore.get("media-data");return null!=e&&void 0!==e.related_media&&e.related_media.length?e.related_media:null}return(0,n.useEffect)((()=>(o.MediaPageStore.on("loaded_media_data",l),()=>o.MediaPageStore.removeListener("loaded_media_data",l))),[]),t&&t.length?n.createElement(fe.k,{className:"items-list-hor",items:!e.hideFirst||"video"!==i&&"audio"!==i?t:t.slice(1),pageItems:o.PageStore.get("config-options").pages.media.related.initialSize,singleLinkContent:!0,horizontalItemsOrientation:!0,hideDate:!0,hideViews:!o.PageStore.get("config-media-item").displayViews,hideAuthor:!o.PageStore.get("config-media-item").displayAuthor}):null}function Ee(e){return n.createElement(fe.k,{className:"items-list-hor",pageItems:9999,maxItems:9999,items:e.items,hideDate:!0,hideViews:!0,hidePlaylistOrderNumber:!1,horizontalItemsOrientation:!0,inPlaylistView:!0,singleLinkContent:!0,playlistActiveItem:e.playlistActiveItem})}be.propTypes={hideFirst:d().bool},be.defaultProps={hideFirst:!0},Ee.propTypes={items:d().array.isRequired,playlistActiveItem:m.PositiveIntegerOrZero},Ee.defaultProps={playlistActiveItem:1};class Se extends n.PureComponent{constructor(e){super(e),this.state={expanded:!0,loopRepeat:o.PlaylistViewStore.get("enabled-loop"),shuffle:o.PlaylistViewStore.get("enabled-shuffle"),savedPlaylist:o.PlaylistViewStore.get("saved-playlist-loop"),title:e.playlistData.title,link:e.playlistData.url,authorName:e.playlistData.user,authorLink:r.LinksContext._currentValue.home+"/user/"+e.playlistData.user,activeItem:e.activeItem,totalMedia:e.playlistData.media_count,items:e.playlistData.playlist_media},this.onHeaderClick=this.onHeaderClick.bind(this),this.onLoopClick=this.onLoopClick.bind(this),this.onShuffleClick=this.onShuffleClick.bind(this),this.onSaveClick=this.onSaveClick.bind(this),this.onLoopRepeatUpdate=this.onLoopRepeatUpdate.bind(this),this.onShuffleUpdate=this.onShuffleUpdate.bind(this),this.onPlaylistSaveUpdate=this.onPlaylistSaveUpdate.bind(this),o.PlaylistViewStore.on("loop-repeat-updated",this.onLoopRepeatUpdate),o.PlaylistViewStore.on("shuffle-updated",this.onShuffleUpdate),o.PlaylistViewStore.on("saved-updated",this.onPlaylistSaveUpdate)}onHeaderClick(e){this.setState({expanded:!this.state.expanded})}onLoopClick(){p.PlaylistViewActions.toggleLoop()}onShuffleClick(){p.PlaylistViewActions.toggleShuffle()}onSaveClick(){p.PlaylistViewActions.toggleSave()}onShuffleUpdate(){this.setState({shuffle:o.PlaylistViewStore.get("enabled-shuffle")},(()=>{this.state.shuffle?p.PageActions.addNotification("Playlist shuffle is on","shuffle-on"):p.PageActions.addNotification("Playlist shuffle is off","shuffle-off")}))}onLoopRepeatUpdate(){this.setState({loopRepeat:o.PlaylistViewStore.get("enabled-loop")},(()=>{this.state.loopRepeat?p.PageActions.addNotification("Playlist loop is on","loop-on"):p.PageActions.addNotification("Playlist loop is off","loop-off")}))}onPlaylistSaveUpdate(){this.setState({savedPlaylist:o.PlaylistViewStore.get("saved-playlist")},(()=>{this.state.savedPlaylist?p.PageActions.addNotification("Added to playlists library","added-to-playlists-lib"):p.PageActions.addNotification("Removed from playlists library","removed-from-playlists-lib")}))}render(){return n.createElement("div",{className:"playlist-view-wrap"},n.createElement("div",{className:"playlist-view"+(this.state.expanded?" playlist-expanded-view":"")},n.createElement("div",{className:"playlist-header"},n.createElement("div",{className:"playlist-title"},n.createElement("a",{href:this.state.link,title:this.state.title},this.state.title)),n.createElement("div",{className:"playlist-meta"},n.createElement("span",null,n.createElement("a",{href:this.state.authorLink,title:this.state.authorName},this.state.authorName)),"  -  ",n.createElement("span",{className:"counter"},this.state.activeItem," / ",this.state.totalMedia)),n.createElement(_.CircleIconButton,{className:"toggle-playlist-view",onClick:this.onHeaderClick},this.state.expanded?n.createElement("i",{className:"material-icons"},"keyboard_arrow_up"):n.createElement("i",{className:"material-icons"},"keyboard_arrow_down"))),this.state.expanded?n.createElement("div",{className:"playlist-actions"},n.createElement(_.CircleIconButton,{className:this.state.loopRepeat?"active":"",onClick:this.onLoopClick,title:"Loop playlist"},n.createElement("i",{className:"material-icons"},"repeat"))):null,this.state.expanded&&this.state.items.length?n.createElement("div",{className:"playlist-media"},n.createElement(Ee,{items:this.state.items,playlistActiveItem:this.state.activeItem})):null))}}Se.propTypes={playlistData:d().object.isRequired,activeItem:m.PositiveIntegerOrZero},Se.defaultProps={};class Pe extends n.PureComponent{constructor(e){if(super(e),this.state={playlistData:e.playlistData,isPlaylistPage:!!e.playlistData,activeItem:0,mediaType:o.MediaPageStore.get("media-type")},e.playlistData){let t=0;for(;t<e.playlistData.playlist_media.length;){if(e.mediaId===e.playlistData.playlist_media[t].friendly_token){this.state.activeItem=t+1;break}t+=1}}this.onMediaLoad=this.onMediaLoad.bind(this)}componentDidMount(){o.MediaPageStore.on("loaded_media_data",this.onMediaLoad)}onMediaLoad(){this.setState({mediaType:o.MediaPageStore.get("media-type")})}render(){return n.createElement("div",{className:"viewer-sidebar"},this.state.isPlaylistPage?n.createElement(Se,{activeItem:this.state.activeItem,playlistData:this.props.playlistData}):"video"===this.state.mediaType||"audio"===this.state.mediaType?n.createElement(ye,null):null,n.createElement(be,{hideFirst:!this.state.isPlaylistPage}))}}var Me=a(9479);Me.Y;class we extends Me.Y{constructor(e){super(e,"media"),this.state={wideLayout:1216<=window.innerWidth,mediaLoaded:!1,mediaLoadFailed:!1,isVideoMedia:!1,theaterMode:!1,pagePlaylistLoaded:!1,pagePlaylistData:o.MediaPageStore.get("playlist-data")},this.onWindowResize=this.onWindowResize.bind(this),this.onMediaLoad=this.onMediaLoad.bind(this),this.onMediaLoadError=this.onMediaLoadError.bind(this),this.onPagePlaylistLoad=this.onPagePlaylistLoad.bind(this),o.MediaPageStore.on("loaded_media_data",this.onMediaLoad),o.MediaPageStore.on("loaded_media_error",this.onMediaLoadError),o.MediaPageStore.on("loaded_page_playlist_data",this.onPagePlaylistLoad)}componentDidMount(){p.MediaPageActions.loadMediaData(),o.PageStore.on("window_resize",this.onWindowResize)}onWindowResize(){this.setState({wideLayout:1216<=window.innerWidth})}onPagePlaylistLoad(){this.setState({pagePlaylistLoaded:!0,pagePlaylistData:o.MediaPageStore.get("playlist-data")})}onMediaLoad(){const e="video"===o.MediaPageStore.get("media-type");e?(this.onViewerModeChange=this.onViewerModeChange.bind(this),o.VideoViewerStore.on("changed_viewer_mode",this.onViewerModeChange),this.setState({mediaLoaded:!0,isVideoMedia:e,theaterMode:o.VideoViewerStore.get("in-theater-mode")})):this.setState({mediaLoaded:!0,isVideoMedia:e})}onViewerModeChange(){this.setState({theaterMode:o.VideoViewerStore.get("in-theater-mode")})}onMediaLoadError(e){this.setState({mediaLoadFailed:!0})}pageContent(){const e="cf viewer-section"+(this.state.theaterMode?" theater-mode":" viewer-wide"),t="viewer-section-nested"+(this.state.theaterMode?" viewer-section":"");return this.state.mediaLoadFailed?n.createElement("div",{className:e},n.createElement(ge,null)):n.createElement("div",{className:e},[n.createElement("div",{className:"viewer-container",key:"viewer-container"},this.state.mediaLoaded&&this.state.pagePlaylistLoaded?this.viewerContainerContent(o.MediaPageStore.get("media-data")):null),n.createElement("div",{key:"viewer-section-nested",className:t},!this.state.wideLayout||this.state.isVideoMedia&&this.state.theaterMode?[n.createElement(he,{key:"viewer-info"}),this.state.pagePlaylistLoaded?n.createElement(Pe,{key:"viewer-sidebar",mediaId:o.MediaPageStore.get("media-id"),playlistData:o.MediaPageStore.get("playlist-data")}):null]:[this.state.pagePlaylistLoaded?n.createElement(Pe,{key:"viewer-sidebar",mediaId:o.MediaPageStore.get("media-id"),playlistData:o.MediaPageStore.get("playlist-data")}):null,n.createElement(he,{key:"viewer-info"})])])}}if(window.MediaCMS.site.devEnv){const e=()=>{let e=null,t=null;const a=window.location.search.split("?")[1];return a&&a.split("&").forEach((a=>{0===a.indexOf("m=")?e=a.split("m=")[1]:0===a.indexOf("pl=")&&(t=a.split("pl=")[1])})),{mediaId:e,playlistId:t}},{mediaId:t,playlistId:a}=e();t&&(window.MediaCMS.mediaId=t),a&&(window.MediaCMS.playlistId=a)}(0,i.C)("page-media",class extends we{viewerContainerContent(e){switch(o.MediaPageStore.get("media-type")){case"video":return n.createElement(r.SiteConsumer,null,(t=>n.createElement(M,{data:e,siteUrl:t.url,inEmbed:!1})));case"audio":return n.createElement(v,null);case"image":return n.createElement(y,null);case"pdf":return n.createElement(b,null)}return n.createElement(l,null)}})},7664:function(e,t,a){"use strict";a.d(t,{CircleIconButton:function(){return i.i},MaterialIcon:function(){return n.Z},NavigationContentApp:function(){return r.V},NavigationMenuList:function(){return o.S},Notifications:function(){return l.$},NumericInputWithUnit:function(){return s._},PopupMain:function(){return d.AP},PopupTop:function(){return d.cp},SpinnerLoader:function(){return c.x},UserThumbnail:function(){return u.c}});var i=a(5321),n=(a(7256),a(3135),a(2828)),r=a(5305),o=a(7201),l=a(6089),s=a(3818),d=a(2901),c=a(6568),u=a(878)},3818:function(e,t,a){"use strict";a.d(t,{_:function(){return o}});var i=a(9471),n=a(8713),r=a.n(n);function o(e){const t=(0,i.useRef)(null),a=(0,i.useRef)(null),[n,r]=(0,i.useState)(null),[o,l]=(0,i.useState)(null);return(0,i.useEffect)((()=>{r(function(e,t,a){if(void 0!==e){let i=null;return i=void 0!==t&&t>e?t:e,i=void 0!==a&&a<i?a:i,i}return void 0!==t?t:void 0!==a?a:void 0}(0+e.defaultValue,e.minValue,e.maxValue)),l(function(e,t){if(!t||!t.length)return null;let a=0;for(;a<t.length;){if(void 0!==t[a].key&&e===t[a].key)return t[a].key;a+=1}return t[0].key}(e.defaultUnit,e.units))})),i.createElement("div",{className:"num-value-unit"},void 0!==e.label?i.createElement("span",{className:"label"},e.label):null,i.createElement("input",{ref:t,className:"value-input",type:"number",value:null!==n?n:"",min:void 0!==e.minValue?e.minValue:null,max:void 0!==e.maxValue?e.maxValue:null,onChange:function(){r(t.current.value),void 0!==e.valueCallback&&e.valueCallback(t.current.value)}}),i.createElement("select",{ref:a,className:"value-unit",onChange:function(){l(a.current.value),void 0!==e.unitCallback&&e.unitCallback(a.current.value)},value:null!==o?o:""},function(){if(!e.units.length)return null;const t=[];let a=0;for(;a<e.units.length;)void 0!==e.units[a].key&&t.push(i.createElement("option",{key:e.units[a].key,value:e.units[a].key},void 0!==e.units[a].label?e.units[a].label:e.units[a].key)),a+=1;return t}()))}o.propTypes={label:r().string,units:r().array.isRequired,defaultUnit:r().string,defaultValue:r().number,minValue:r().number,maxValue:r().number,valueCallback:r().func,unitCallback:r().func}},878:function(e,t,a){"use strict";a.d(t,{c:function(){return d}});var i=a(9471),n=a(8713),r=a.n(n),o=a(6387),l=a(5321),s=a(2828);function d(e){const{thumbnail:t}=(0,o.useUser)(),a={"aria-label":"Account profile photo that opens list of options and settings pages links",className:"thumbnail"};switch(e.isButton?void 0!==e.onClick&&(a.onClick=e.onClick):a.type="span",e.size){case"small":case"large":a.className+=" "+e.size+"-thumb"}return i.createElement(l.i,a,t?i.createElement("img",{src:t,alt:""}):i.createElement(s.Z,{type:"person"}))}d.propTypes={isButton:r().bool,size:r().oneOf(["small","medium","large"]),onClick:r().func},d.defaultProps={isButton:!1,size:"medium"}},6880:function(e,t,a){var i,n,r,o=a(8974);n=[a(4480)],void 0===(r="function"==typeof(i=function(e){"use strict";var t,a=(t=e)&&t.__esModule?t:{default:t};var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n={markerStyle:{width:"7px","border-radius":"30%","background-color":"red"},markerTip:{display:!0,text:function(e){return"Break: "+e.text},time:function(e){return e.time}},breakOverlay:{display:!0,displayTime:3,text:function(e){return"Break overlay: "+e.overlayText},style:{width:"100%",height:"20%","background-color":"rgba(0,0,0,0.7)",color:"white","font-size":"17px"}},onMarkerClick:function(e){},onMarkerReached:function(e,t){},markers:[]};function r(e){var t;try{t=e.getBoundingClientRect()}catch(e){t={top:0,bottom:0,left:0,width:0,height:0,right:0}}return t}var l=-1;a.default.plugin("markers",(function(e){if(!a.default.mergeOptions){var t=function(e){return!!e&&"object"===(void 0===e?"undefined":i(e))&&"[object Object]"===toString.call(e)&&e.constructor===Object};a.default.mergeOptions=function e(a,i){var n={};return[a,i].forEach((function(a){a&&Object.keys(a).forEach((function(i){var r=a[i];t(r)?(t(n[i])||(n[i]={}),n[i]=e(n[i],r)):n[i]=r}))})),n}}a.default.createEl||(a.default.createEl=function(e,t,i){var n=a.default.Player.prototype.createEl(e,t);return i&&Object.keys(i).forEach((function(e){n.setAttribute(e,i[e])})),n});var s=a.default.mergeOptions(n,e),d={},c=[],u=l,m=this,p=null,h=null,g=l;function f(){c.sort((function(e,t){return s.markerTip.time(e)-s.markerTip.time(t)}))}function v(e){e.forEach((function(e){var t;e.key=(t=(new Date).getTime(),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var a=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?a:3&a|8).toString(16)}))),m.el().querySelector(".vjs-progress-holder").appendChild(function(e){var t=a.default.createEl("div",{},{"data-marker-key":e.key,"data-marker-time":s.markerTip.time(e)});return b(e,t),t.addEventListener("click",(function(t){var a=!1;if("function"==typeof s.onMarkerClick&&(a=!1===s.onMarkerClick(e)),!a){var i=this.getAttribute("data-marker-key");m.currentTime(s.markerTip.time(d[i]))}})),s.markerTip.display&&function(e){e.addEventListener("mouseover",(function(){var t=d[e.getAttribute("data-marker-key")];if(p){p.querySelector(".vjs-tip-inner").innerText=s.markerTip.text(t),p.style.left=y(t)+"%";var a=r(p),i=r(e);p.style.marginLeft=-parseFloat(a.width/2)+parseFloat(i.width/4)+"px",p.style.visibility="visible"}})),e.addEventListener("mouseout",(function(){p&&(p.style.visibility="hidden")}))}(t),t}(e)),d[e.key]=e,c.push(e)})),f()}function y(e){return s.markerTip.time(e)/m.duration()*100}function b(e,t){t.className="vjs-marker "+(e.class||""),Object.keys(s.markerStyle).forEach((function(e){t.style[e]=s.markerStyle[e]}));var a=e.time/m.duration();if((a<0||a>1)&&(t.style.display="none"),t.style.left=y(e)+"%",e.duration)t.style.width=e.duration/m.duration()*100+"%",t.style.marginLeft="0px";else{var i=r(t);t.style.marginLeft=i.width/2+"px"}}function E(e){h&&(g=l,h.style.visibility="hidden"),u=l;var t=[];e.forEach((function(e){var a=c[e];if(a){delete d[a.key],t.push(e);var i=m.el().querySelector(".vjs-marker[data-marker-key='"+a.key+"']");i&&i.parentNode.removeChild(i)}}));try{t.reverse(),t.forEach((function(e){c.splice(e,1)}))}catch(e){o.log(e)}f()}function S(){if(s.breakOverlay.display&&!(u<0)){var e=m.currentTime(),t=c[u],a=s.markerTip.time(t);e>=a&&e<=a+s.breakOverlay.displayTime?(g!==u&&(g=u,h&&(h.querySelector(".vjs-break-overlay-text").innerHTML=s.breakOverlay.text(t))),h&&(h.style.visibility="visible")):(g=l,h&&(h.style.visibility="hidden"))}}function P(){(function(){if(c.length){var t=function(e){return e<c.length-1?s.markerTip.time(c[e+1]):m.duration()},a=m.currentTime(),i=l;if(u!==l){var n=t(u);if(a>=s.markerTip.time(c[u])&&a<n)return;if(u===c.length-1&&a===m.duration())return}if(a<s.markerTip.time(c[0]))i=l;else for(var r=0;r<c.length;r++)if(n=t(r),a>=s.markerTip.time(c[r])&&a<n){i=r;break}i!==u&&(i!==l&&e.onMarkerReached&&e.onMarkerReached(c[i],i),u=i)}})(),S(),e.onTimeUpdateAfterMarkerUpdate&&e.onTimeUpdateAfterMarkerUpdate()}function M(){s.markerTip.display&&(p=a.default.createEl("div",{className:"vjs-tip",innerHTML:"<div class='vjs-tip-arrow'></div><div class='vjs-tip-inner'></div>"}),m.el().querySelector(".vjs-progress-holder").appendChild(p)),m.markers.removeAll(),v(s.markers),s.breakOverlay.display&&(h=a.default.createEl("div",{className:"vjs-break-overlay",innerHTML:"<div class='vjs-break-overlay-text'></div>"}),Object.keys(s.breakOverlay.style).forEach((function(e){h&&(h.style[e]=s.breakOverlay.style[e])})),m.el().appendChild(h),g=l),P(),m.on("timeupdate",P),m.off("loadedmetadata")}m.on("loadedmetadata",(function(){M()})),m.markers={getMarkers:function(){return c},next:function(){for(var e=m.currentTime(),t=0;t<c.length;t++){var a=s.markerTip.time(c[t]);if(a>e){m.currentTime(a);break}}},prev:function(){for(var e=m.currentTime(),t=c.length-1;t>=0;t--){var a=s.markerTip.time(c[t]);if(a+.5<e)return void m.currentTime(a)}},add:function(e){v(e)},remove:function(e){E(e)},removeAll:function(){for(var e=[],t=0;t<c.length;t++)e.push(t);E(e)},updateTime:function(e){!function(e){c.forEach((function(t){var a=m.el().querySelector(".vjs-marker[data-marker-key='"+t.key+"']"),i=s.markerTip.time(t);(e||a.getAttribute("data-marker-time")!==i)&&(b(t,a),a.setAttribute("data-marker-time",i))})),f()}(e)},reset:function(e){m.markers.removeAll(),v(e)},destroy:function(){m.markers.removeAll(),h&&h.remove(),p&&p.remove(),m.off("timeupdate",S),delete m.markers}}}))})?i.apply(t,n):i)||(e.exports=r)},5615:function(e,t,a){"use strict";a.d(t,{L9:function(){return m},lg:function(){return u}});var i=a(9471),n=a(8713),r=a.n(n),o=a(4571),l=a.n(o),s=a(4480),d=a.n(s);function c(e,t){let a=l()(e,{});return""!==a.origin&&"null"!==a.origin&&a.origin||(a=l()(t+"/"+e.replace(/^\//g,""),{})),a.toString()}function u(e){return i.createElement("div",{className:"error-container"},i.createElement("div",{className:"error-container-inner"},i.createElement("span",{className:"icon-wrap"},i.createElement("i",{className:"material-icons"},"error_outline")),i.createElement("span",{className:"msg-wrap"},e.errorMessage)))}function m(e){const t=(0,i.useRef)(null);let a=null;const n={playerVolume:e.playerVolume,playerSoundMuted:e.playerSoundMuted,videoQuality:e.videoQuality,videoPlaybackSpeed:e.videoPlaybackSpeed,inTheaterMode:e.inTheaterMode};function r(){void 0!==e.onClickNextCallback&&e.onClickNextCallback()}function o(){void 0!==e.onClickPreviousCallback&&e.onClickPreviousCallback()}function l(t){n.playerVolume!==t.volume&&(n.playerVolume=t.volume),n.playerSoundMuted!==t.soundMuted&&(n.playerSoundMuted=t.soundMuted),n.videoQuality!==t.quality&&(n.videoQuality=t.quality),n.videoPlaybackSpeed!==t.playbackSpeed&&(n.videoPlaybackSpeed=t.playbackSpeed),n.inTheaterMode!==t.theaterMode&&(n.inTheaterMode=t.theaterMode),void 0!==e.onStateUpdateCallback&&e.onStateUpdateCallback(t)}function s(){if(null!==a||null!==e.errorMessage)return;if(e.inEmbed||(window.removeEventListener("focus",s),document.removeEventListener("visibilitychange",s)),!t.current)return;e.inEmbed||t.current.focus();const i={on:!1};if(void 0!==e.subtitlesInfo&&null!==e.subtitlesInfo&&e.subtitlesInfo.length){i.languages=[];let t=0;for(;t<e.subtitlesInfo.length;)void 0!==e.subtitlesInfo[t].src&&void 0!==e.subtitlesInfo[t].srclang&&void 0!==e.subtitlesInfo[t].label&&i.languages.push({src:c(e.subtitlesInfo[t].src,e.siteUrl),srclang:e.subtitlesInfo[t].srclang,label:e.subtitlesInfo[t].label}),t+=1;i.languages.length&&(i.on=!0)}a=new(d())(t.current,{enabledTouchControls:!0,sources:e.sources,poster:e.poster,autoplay:e.enableAutoplay,bigPlayButton:!0,controlBar:{theaterMode:e.hasTheaterMode,pictureInPicture:!1,next:!!e.hasNextLink,previous:!!e.hasPreviousLink},subtitles:i,cornerLayers:e.cornerLayers,videoPreviewThumb:e.previewSprite},{volume:n.playerVolume,soundMuted:n.playerSoundMuted,theaterMode:n.inTheaterMode,theSelectedQuality:void 0,theSelectedPlaybackSpeed:n.videoPlaybackSpeed||1},e.info,[.25,.5,.75,1,1.25,1.5,1.75,2],l,r,o),void 0!==e.onPlayerInitCallback&&e.onPlayerInitCallback(a,t.current)}return n.playerVolume=null===n.playerVolume?1:Math.max(Math.min(Number(n.playerVolume),1),0),n.playerSoundMuted=null!==n.playerSoundMuted&&n.playerSoundMuted,n.videoQuality=null!==n.videoQuality?n.videoQuality:"Auto",n.videoPlaybackSpeed=null!==n.videoPlaybackSpeed&&n.videoPlaybackSpeed,n.inTheaterMode=null!==n.inTheaterMode&&n.inTheaterMode,(0,i.useEffect)((()=>(e.inEmbed||document.hasFocus()||"visible"===document.visibilityState?s():(window.addEventListener("focus",s),document.addEventListener("visibilitychange",s)),a&&a.player.one("loadedmetadata",(()=>{const e=new URLSearchParams(window.location.search),t=Number(e.get("t")),i=isNaN(t)?0:t;a.player.currentTime(i)})),()=>{null!==a&&(videojs(t.current).dispose(),a=null),void 0!==e.onUnmountCallback&&e.onUnmountCallback()})),[]),null===e.errorMessage?i.createElement("video",{ref:t,className:"video-js vjs-mediacms native-dimensions"}):i.createElement("div",{className:"error-container"},i.createElement("div",{className:"error-container-inner"},i.createElement("span",{className:"icon-wrap"},i.createElement("i",{className:"material-icons"},"error_outline")),i.createElement("span",{className:"msg-wrap"},e.errorMessage)))}u.propTypes={errorMessage:r().string.isRequired},m.propTypes={playerVolume:r().string,playerSoundMuted:r().bool,videoQuality:r().string,videoPlaybackSpeed:r().number,inTheaterMode:r().bool,siteId:r().string.isRequired,siteUrl:r().string.isRequired,errorMessage:r().string,cornerLayers:r().object,subtitlesInfo:r().array.isRequired,inEmbed:r().bool.isRequired,sources:r().array.isRequired,info:r().object.isRequired,enableAutoplay:r().bool.isRequired,hasTheaterMode:r().bool.isRequired,hasNextLink:r().bool.isRequired,hasPreviousLink:r().bool.isRequired,poster:r().string,previewSprite:r().object,onClickPreviousCallback:r().func,onClickNextCallback:r().func,onPlayerInitCallback:r().func,onStateUpdateCallback:r().func,onUnmountCallback:r().func},m.defaultProps={errorMessage:null,cornerLayers:{}}},7789:function(e,t,a){"use strict";a.d(t,{F:function(){return h}});var i=a(9471),n=a(8713),r=a.n(n),o=a(4571),l=a.n(o),s=a(8790),d=a(1838),c=a(7154),u=a(2818),m=a(5615),p=a(8974);function h(e){const t=(0,i.useContext)(s.ApiUrlContext),a=(0,i.useContext)(s.SiteContext),[n,r]=(0,i.useState)(null),[o,h]=(0,i.useState)(null),[g,f]=(0,i.useState)(null),[v,y]=(0,i.useState)([]),[b,E]=(0,i.useState)({}),[S,P]=(0,i.useState)([]),[M,w]=(0,i.useState)({}),k={videoQuality:new c.BrowserCache(a.id,86400).get("video-quality")};k.videoQuality=null!==k.videoQuality?k.videoQuality:"Auto";let _=null,N=null,C=null,x=function(){let t=new(l())(e.pageLink).query;return t?(t=t.substring(1),t.split("&"),t=t.length?t.split("="):[]):t=[],t}();if(x.length){let e=0;for(;e<x.length;)"m"===x[e]&&(C=x[e+1]),e+=2}function L(e){if(void 0===e||!e||void 0===e.data||!e.data)return;let t,i;N=e.data;const n=[];let o=null,l=(0,u.uW)(N.encodings_info,N.hls_info),s=null,c=null;if("string"==typeof N.poster_url?o=(0,d.formatInnerLink)(N.poster_url,a.url):"string"==typeof N.thumbnail_url&&(o=(0,d.formatInnerLink)(N.thumbnail_url,a.url)),Object.keys(l).length){const e=(0,u.n1)();let r=k.videoQuality;(null===r||"Auto"===r&&void 0===l.Auto)&&(r=720);let o=(0,u.OQ)(r,l);for("Auto"===r&&void 0!==l.Auto&&n.push({src:l.Auto.url[0]}),i=0;i<l[o].format.length;){if("hls"===l[o].format[i]){n.push({src:l[o].url[i]});break}i+=1}for(i in N.encodings_info[o])N.encodings_info[o].hasOwnProperty(i)&&e.support[i]&&(t=N.encodings_info[o][i].url,t&&(t=(0,d.formatInnerLink)(t,a.url),n.push({src:t,encodings_status:N.encodings_info[o][i].status})))}else l=null;if(1===n.length&&"running"===n[0].encodings_status&&(s="encodingRunning",c="Media encoding is currently running. Try again in few minutes."),null!==s)switch(s){case"encodingRunning":case"encodingPending":case"encodingFailed":break;default:p.warn("VIDEO DEBUG:","Video files don't exist")}r(s),h(c),f(o),y(n),E(l),P(N.subtitles_info),w(N.sprites_url?{url:(0,d.formatInnerLink)(N.sprites_url,a.url),frame:{width:160,height:90,seconds:10}}:null);const m=document.querySelector(".feat-first-item .item .item-description > div");m&&(m.innerHTML=N.summary)}function V(e){if(void 0!==e&&void 0!==e.type)switch(e.type){case"network":case"private":case"unavailable":r(e.type),h(void 0!==e.message?e.message:"Αn error occurred while loading the media's data")}}return null!==C&&(_=t.media+"/"+C),(0,i.useEffect)((()=>{null!==_&&(0,d.getRequest)(_,!1,L,V)}),[]),v.length?i.createElement("div",{className:"video-player"},i.createElement(m.L9,{siteId:a.id,siteUrl:a.url,info:b,sources:v,poster:g,previewSprite:M,subtitlesInfo:S,enableAutoplay:!1,inEmbed:!1,hasTheaterMode:!1,hasNextLink:!1,hasPreviousLink:!1,errorMessage:o})):null}h.propTypes={pageLink:r().string.isRequired}}},a={};function i(e){var n=a[e];if(void 0!==n)return n.exports;var r=a[e]={exports:{}};return t[e].call(r.exports,r,r.exports,i),r.exports}i.m=t,e=[],i.O=function(t,a,n,r){if(!a){var o=1/0;for(c=0;c<e.length;c++){a=e[c][0],n=e[c][1],r=e[c][2];for(var l=!0,s=0;s<a.length;s++)(!1&r||o>=r)&&Object.keys(i.O).every((function(e){return i.O[e](a[s])}))?a.splice(s--,1):(l=!1,r<o&&(o=r));if(l){e.splice(c--,1);var d=n();void 0!==d&&(t=d)}}return t}r=r||0;for(var c=e.length;c>0&&e[c-1][2]>r;c--)e[c]=e[c-1];e[c]=[a,n,r]},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,{a:t}),t},i.d=function(e,t){for(var a in t)i.o(t,a)&&!i.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.j=201,function(){var e={201:0};i.O.j=function(t){return 0===e[t]};var t=function(t,a){var n,r,o=a[0],l=a[1],s=a[2],d=0;if(o.some((function(t){return 0!==e[t]}))){for(n in l)i.o(l,n)&&(i.m[n]=l[n]);if(s)var c=s(i)}for(t&&t(a);d<o.length;d++)r=o[d],i.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return i.O(c)},a=self.webpackChunkmediacms_frontend=self.webpackChunkmediacms_frontend||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var n=i.O(void 0,[276],(function(){return i(6369)}));n=i.O(n)}();